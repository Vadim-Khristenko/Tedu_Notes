# –ö–æ–Ω—Å–ø–µ–∫—Ç –æ—Ç 30.09.2025 | –õ–µ–∫—Ü–∏—è —É—Ä–æ–≤–Ω—è –•–∞—Ä–¥ (–ü–∞—Ä–∞–ª–ª–µ–ª—å: B-X)
## –¢–µ–º–∞: –£–≥–ª—É–±–ª–µ–Ω–Ω–∞—è —Ç–µ–æ—Ä–∏—è —á–∏—Å–µ–ª.

> –ê–≤—Ç–æ—Ä: –í–∞–¥–∏–º –•—Ä–∏—Å—Ç–µ–Ω–∫–∫–æ  
> –ß–µ—Å—Ç–Ω–æ –≤ –∫–æ–Ω—Å–ø–µ–∫—Ç–µ –ø–æ—á—Ç–∏ –≤—Å—ë –ø–µ—Ä–µ—Å–∫–∞–∑–∞–Ω–æ —Å–≤–æ–∏–º–∏ —Å–ª–æ–≤–∞–º–∏ –∏ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–æ –ø–æ–¥ –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏.  
> –ù—É –∏ –µ—â—ë –¥–æ–∫-–≤–æ –µ—Å—Ç—å –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Ç–µ–æ—Ä–µ–º, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞ –ª–µ–∫—Ü–∏–∏ –ø—Ä–æ—à–ª–∏ –º–µ—Ç–æ–¥–æ–º —Å–∫–∏–ø–∞.  
> –î–æ–±–∞–≤–∏–ª –µ—â—ë –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–º–µ—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –±—ã–ª–∏ –Ω–∞ –ª–µ–∫—Ü–∏–∏.  
> –ê –µ—â—ë **–î–ê–õ –õ–ï–ì–ï–ù–î–ê–†–ù–£–Æ –ö–û–ü–ò-–ü–ê–°–¢ –õ–ò–ë–£**.

---



## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ  
> –¢—É—Ç –¥–æ—Ö—Ä–µ–Ω–∞ –≤—Å–µ–≥–æ, –∞ –≤—ã —á–µ–≥–æ –æ–∂–∏–¥–∞–ª–∏?

- [–û–±–æ–∑–Ω–∞—á–µ–Ω–∏—è –∏ –±–∞–∑–æ–≤—ã–µ —à—Ç—É–∫–∏](#–æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è-–∏-–±–∞–∑–æ–≤—ã–µ-—à—Ç—É–∫–∏)
  - [–ë—ã—Å—Ç—Ä—ã–µ —Ñ–∞–∫—Ç—ã](#–±—ã—Å—Ç—Ä—ã–µ-—Ñ–∞–∫—Ç—ã)
  - [–ü—Ä–∏–º–µ—Ä—ã –º–æ–¥—É–ª–µ–π –¥–ª—è CP](#–ø—Ä–∏–º–µ—Ä—ã-–º–æ–¥—É–ª–µ–π-–¥–ª—è-cp)
  - [–¢–∞–±–ª–∏—Ü–∞ –º–∞–ª—ã—Ö –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã—Ö –∫–æ—Ä–Ω–µ–π](#—Ç–∞–±–ª–∏—Ü–∞-–º–∞–ª—ã—Ö-–ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã—Ö-–∫–æ—Ä–Ω–µ–π)
  - [–¢–∞–±–ª–∏—Ü–∞ –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—ã—Ö –≤—ã—á–µ—Ç–æ–≤](#—Ç–∞–±–ª–∏—Ü–∞-–∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—ã—Ö-–≤—ã—á–µ—Ç–æ–≤)
- [–ü–æ–ª–µ $\mathbb{Z}_p$: —á—Ç–æ —ç—Ç–æ –∏ –∑–∞—á–µ–º](#–ø–æ–ª–µ-mathbbz_p-—á—Ç–æ-—ç—Ç–æ-–∏-–∑–∞—á–µ–º)
  - [–ê–ª–≥–µ–±—Ä–∞–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞: –æ—Ç –∫–æ–ª—å—Ü–∞ –∫ –ø–æ–ª—é](#–∞–ª–≥–µ–±—Ä–∞–∏—á–µ—Å–∫–∞—è-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–æ—Ç-–∫–æ–ª—å—Ü–∞-–∫-–ø–æ–ª—é)
  - [–ú—É–ª—å—Ç–∏–ø–ª–∏–∫–∞—Ç–∏–≤–Ω–∞—è –≥—Ä—É–ø–ø–∞ $\mathbb{Z}_p^*$](#–º—É–ª—å—Ç–∏–ø–ª–∏–∫–∞—Ç–∏–≤–Ω–∞—è-–≥—Ä—É–ø–ø–∞-mathbbz_p)
  - [–ö–∞–∫ –¥–µ–ª–∏—Ç—å ‚Äî —Ç—Ä–∏ —Å–ø–æ—Å–æ–±–∞](#–∫–∞–∫-–¥–µ–ª–∏—Ç—å--—Ç—Ä–∏-—Å–ø–æ—Å–æ–±–∞)
- [–ú–Ω–æ–≥–æ—á–ª–µ–Ω—ã –≤ $\mathbb{Z}_p$: –±—ã—Å—Ç—Ä–æ –∏ –±–µ–∑ –ø–∞–Ω–∏–∫–∏](#–º–Ω–æ–≥–æ—á–ª–µ–Ω—ã-–≤-mathbbz_p-–±—ã—Å—Ç—Ä–æ-–∏-–±–µ–∑-–ø–∞–Ω–∏–∫–∏)
  - [–û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –º–Ω–æ–≥–æ—á–ª–µ–Ω–∞–º–∏](#–æ—Å–Ω–æ–≤–Ω—ã–µ-–æ–ø–µ—Ä–∞—Ü–∏–∏-—Å-–º–Ω–æ–≥–æ—á–ª–µ–Ω–∞–º–∏)
  - [–î–µ–ª–µ–Ω–∏–µ –º–Ω–æ–≥–æ—á–ª–µ–Ω–æ–≤ —Å –æ—Å—Ç–∞—Ç–∫–æ–º](#–¥–µ–ª–µ–Ω–∏–µ-–º–Ω–æ–≥–æ—á–ª–µ–Ω–æ–≤-—Å-–æ—Å—Ç–∞—Ç–∫–æ–º)
  - [–ù–û–î –º–Ω–æ–≥–æ—á–ª–µ–Ω–æ–≤](#–Ω–æ–¥-–º–Ω–æ–≥–æ—á–ª–µ–Ω–æ–≤-–∞–ª–≥–æ—Ä–∏—Ç–º-–µ–≤–∫–ª–∏–¥–∞)
  - [–ù–µ–ø—Ä–∏–≤–æ–¥–∏–º—ã–µ –º–Ω–æ–≥–æ—á–ª–µ–Ω—ã](#–Ω–µ–ø—Ä–∏–≤–æ–¥–∏–º—ã–µ-–º–Ω–æ–≥–æ—á–ª–µ–Ω—ã)
  - [–ò–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è –õ–∞–≥—Ä–∞–Ω–∂–∞](#–∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è-–ª–∞–≥—Ä–∞–Ω–∂)
- [–§—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ —Ç–µ–æ—Ä–µ–º—ã ‚Äî –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –∏ –∏–Ω—Ç—É–∏—Ü–∏—è](#—Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ-—Ç–µ–æ—Ä–µ–º—ã--–¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞-–∏-–∏–Ω—Ç—É–∏—Ü–∏—è)
  - [–ú–∞–ª–∞—è —Ç–µ–æ—Ä–µ–º–∞ –§–µ—Ä–º–∞](#–º–∞–ª–∞—è-—Ç–µ–æ—Ä–µ–º–∞-—Ñ–µ—Ä–º–∞)
  - [–¢–µ–æ—Ä–µ–º–∞ –≠–π–ª–µ—Ä–∞](#—Ç–µ–æ—Ä–µ–º–∞-—ç–π–ª–µ—Ä–∞-–æ–±–æ–±—â–µ–Ω–∏–µ)
- [–ü—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–µ (–ø–µ—Ä–≤–æ–æ–±—Ä–∞–∑–Ω—ã–µ) –∫–æ—Ä–Ω–∏](#–ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–µ-–ø–µ—Ä–≤–æ–æ–±—Ä–∞–∑–Ω—ã–µ-–∫–æ—Ä–Ω–∏--–∫—Ç–æ-–æ–Ω–∏-–∏-–∑–∞—á–µ–º-–Ω—É–∂–Ω—ã)
  - [–¢–µ–æ—Ä–µ–º–∞ –æ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–∏](#—Ç–µ–æ—Ä–µ–º–∞-–æ-—Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–∏)
  - [–°–∫–æ–ª—å–∫–æ –∏—Ö?](#—Å–∫–æ–ª—å–∫–æ-–∏—Ö)
  - [–ó–∞—á–µ–º –æ–Ω–∏ –Ω—É–∂–Ω—ã?](#–∑–∞—á–µ–º-–æ–Ω–∏-–Ω—É–∂–Ω—ã)
  - [–°–≤–æ–π—Å—Ç–≤–∞ –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã—Ö –∫–æ—Ä–Ω–µ–π](#—Å–≤–æ–π—Å—Ç–≤–∞-–ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã—Ö-–∫–æ—Ä–Ω–µ–π)
  - [–ö–∞–∫ –∏—Å–∫–∞—Ç—å –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π –∫–æ—Ä–µ–Ω—å?](#–∫–∞–∫-–∏—Å–∫–∞—Ç—å-–ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π-–∫–æ—Ä–µ–Ω—å)
- [–ö–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è –≤ $\mathbb{Z}_p$](#–∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ-—É—Ä–∞–≤–Ω–µ–Ω–∏—è-–≤-mathbbz_p)
- [–°–∏–º–≤–æ–ª –õ–µ–∂–∞–Ω–¥—Ä–∞ –∏ –∫—Ä–∏—Ç–µ—Ä–∏–π –≠–π–ª–µ—Ä–∞](#—Å–∏–º–≤–æ–ª-–ª–µ–∂–∞–Ω–¥—Ä–∞-–∏-–∫—Ä–∏—Ç–µ—Ä–∏–π-—ç–π–ª–µ—Ä–∞)
  - [–°–≤–æ–π—Å—Ç–≤–∞ —Å–∏–º–≤–æ–ª–∞ –õ–µ–∂–∞–Ω–¥—Ä–∞](#—Å–≤–æ–π—Å—Ç–≤–∞-—Å–∏–º–≤–æ–ª–∞-–ª–µ–∂–∞–Ω–¥—Ä–∞)
  - [–ë—ã—Å—Ç—Ä–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ](#–±—ã—Å—Ç—Ä–æ–µ-–≤—ã—á–∏—Å–ª–µ–Ω–∏–µ-—Å–∏–º–≤–æ–ª–∞-–ª–µ–∂–∞–Ω–¥—Ä–∞)
  - [–°–∏–º–≤–æ–ª –Ø–∫–æ–±–∏](#—Å–∏–º–≤–æ–ª-—è–∫–æ–±–∏-–æ–±–æ–±—â–µ–Ω–∏–µ)
  - [–ü—Ä–∏–º–µ—Ä—ã –≤—ã—á–∏—Å–ª–µ–Ω–∏–π](#–ø—Ä–∏–º–µ—Ä—ã-–≤—ã—á–∏—Å–ª–µ–Ω–∏–π)
- [–ê–ª–≥–æ—Ä–∏—Ç–º –¢–æ–Ω–µ–ª–ª–∏‚Äì–®–µ–Ω–∫—Å–∞](#–∞–ª–≥–æ—Ä–∏—Ç–º-—Ç–æ–Ω–µ–ª–ª–∏—à–µ–Ω–∫—Å–∞--–∫–∞–∫-–∏–∑–≤–ª–µ—á—å-–∫–æ—Ä–µ–Ω—å-–ø–æ-–º–æ–¥—É–ª—é)
- [–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏ –∏ –ø–∞—Ç—Ç–µ—Ä–Ω—ã —Ä–µ—à–µ–Ω–∏–π](#–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ-–∑–∞–¥–∞—á–∏-–∏-–ø–∞—Ç—Ç–µ—Ä–Ω—ã-—Ä–µ—à–µ–Ω–∏–π)
  - [–ë–∏–Ω–æ–º–∏–∞–ª—å–Ω—ã–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã](#–∑–∞–¥–∞—á–∞-1-–≤—ã—á–∏—Å–ª–µ–Ω–∏–µ-–±–∏–Ω–æ–º–∏–∞–ª—å–Ω—ã—Ö-–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤)
  - [–°–∏—Å—Ç–µ–º—ã –ª–∏–Ω–µ–π–Ω—ã—Ö —É—Ä–∞–≤–Ω–µ–Ω–∏–π](#–∑–∞–¥–∞—á–∞-2-—Ä–µ—à–µ–Ω–∏–µ-—Å–∏—Å—Ç–µ–º—ã-–ª–∏–Ω–µ–π–Ω—ã—Ö-—É—Ä–∞–≤–Ω–µ–Ω–∏–π)
  - [–ü–æ–¥—Å—á—ë—Ç –ø—É—Ç–µ–π –≤ –≥—Ä–∞—Ñ–µ](#–∑–∞–¥–∞—á–∞-3-–ø–æ–¥—Å—á—ë—Ç-–ø—É—Ç–µ–π-–≤-–≥—Ä–∞—Ñ–µ)
  - [–°—É–º–º–∞ –¥–≤—É—Ö –∫–≤–∞–¥—Ä–∞—Ç–æ–≤](#–∑–∞–¥–∞—á–∞-4-—Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ-—á–∏—Å–ª–∞-–Ω–∞-—Å—É–º–º—É-–¥–≤—É—Ö-–∫–≤–∞–¥—Ä–∞—Ç–æ–≤)
  - [–î–∏—Å–∫—Ä–µ—Ç–Ω–æ–µ –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—Ä–æ–≤–∞–Ω–∏–µ](#–∑–∞–¥–∞—á–∞-5-–¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–µ-–ª–æ–≥–∞—Ä–∏—Ñ–º–∏—Ä–æ–≤–∞–Ω–∏–µ-real-challenge)
  - [NTT –¥–ª—è —É–º–Ω–æ–∂–µ–Ω–∏—è](#–∑–∞–¥–∞—á–∞-6-ntt-–¥–ª—è-—É–º–Ω–æ–∂–µ–Ω–∏—è-–±–æ–ª—å—à–∏—Ö-—á–∏—Å–µ–ª)
- [–®–ø–∞—Ä–≥–∞–ª–∫–∞: —á—Ç–æ –∑–∞–ø–æ–º–Ω–∏—Ç—å](#—à–ø–∞—Ä–≥–∞–ª–∫–∞-—á—Ç–æ-–∑–∞–ø–æ–º–Ω–∏—Ç—å)
- [–ü–æ–ª–µ–∑–Ω—ã–µ –ª–∞–π—Ñ—Ö–∞–∫–∏ –∏ —Ç–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏](#–ø–æ–ª–µ–∑–Ω—ã–µ-–ª–∞–π—Ñ—Ö–∞–∫–∏-–∏-—Ç–∏–ø–∏—á–Ω—ã–µ-–æ—à–∏–±–∫–∏)
- [–°–≤—è–∑—å —Å –¥—Ä—É–≥–∏–º–∏ —Ä–∞–∑–¥–µ–ª–∞–º–∏ –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏](#—Å–≤—è–∑—å-—Å-–¥—Ä—É–≥–∏–º–∏-—Ä–∞–∑–¥–µ–ª–∞–º–∏-–º–∞—Ç–µ–º–∞—Ç–∏–∫–∏)
- [–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã](#–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ-–∞–ª–≥–æ—Ä–∏—Ç–º—ã)
  - [–ö–∏—Ç–∞–π—Å–∫–∞—è —Ç–µ–æ—Ä–µ–º–∞ –æ–± –æ—Å—Ç–∞—Ç–∫–∞—Ö](#–∫–∏—Ç–∞–π—Å–∫–∞—è-—Ç–µ–æ—Ä–µ–º–∞-–æ–±-–æ—Å—Ç–∞—Ç–∫–∞—Ö-crt)
  - [–ê–ª–≥–æ—Ä–∏—Ç–º –ü–æ–ª–ª–∞—Ä–¥–∞ œÅ](#–∞–ª–≥–æ—Ä–∏—Ç–º-–ø–æ–ª–ª–∞—Ä–¥–∞-œÅ-–¥–ª—è-–¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–≥–æ-–ª–æ–≥–∞—Ä–∏—Ñ–º–∞)
  - [–¢–µ—Å—Ç –ú–∏–ª–ª–µ—Ä–∞-–†–∞–±–∏–Ω–∞](#—Ç–µ—Å—Ç-–º–∏–ª–ª–µ—Ä–∞-—Ä–∞–±–∏–Ω–∞-–ø—Ä–æ–≤–µ—Ä–∫–∞-–ø—Ä–æ—Å—Ç–æ—Ç—ã)
- [–ë–∞–∑–æ–≤–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ ‚Äî –≥–æ—Ç–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏](#–±–∞–∑–æ–≤–∞—è-–±–∏–±–ª–∏–æ—Ç–µ–∫–∞--–≥–æ—Ç–æ–≤—ã–µ-—Ñ—É–Ω–∫—Ü–∏–∏)
- [–í–∏–∑—É–∞–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∏ —Å—Ö–µ–º—ã](#–≤–∏–∑—É–∞–ª—å–Ω—ã–µ-–ø—Ä–∏–º–µ—Ä—ã-–∏-—Å—Ö–µ–º—ã)

---

## –û–±–æ–∑–Ω–∞—á–µ–Ω–∏—è –∏ –±–∞–∑–æ–≤—ã–µ —à—Ç—É–∫–∏

| –û–±–æ–∑–Ω–∞—á–µ–Ω–∏–µ | –ß—Ç–æ –∑–Ω–∞—á–∏—Ç | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|------------|------------|-------------|
| $p$ | –ø—Ä–æ—Å—Ç–æ–µ —á–∏—Å–ª–æ (–æ–±—ã—á–Ω–æ $10^9+7$, $998244353$) | –ø–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ –ø—Ä–æ—Å—Ç–æ–µ –≤ –∑–∞–¥–∞—á–∞—Ö |
| $\mathbb{Z}_p$ | –º–Ω–æ–∂–µ—Å—Ç–≤–æ $\{0, 1, ..., p-1\}$ —Å –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏ –ø–æ –º–æ–¥—É–ª—é $p$ | —ç—Ç–æ –ø–æ–ª–µ! |
| $\mathbb{Z}_p^*$ | $\{1, 2, ..., p-1\}$ ‚Äî –Ω–µ–Ω—É–ª–µ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã | –≥—Ä—É–ø–ø–∞ –ø–æ —É–º–Ω–æ–∂–µ–Ω–∏—é |
| $a^{-1} \bmod p$ | –æ–±—Ä–∞—Ç–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –∫ $a$ | $a \cdot a^{-1} \equiv 1 \pmod p$ |
| $a^{p-2} \bmod p$ | —Å–ø–æ—Å–æ–± –Ω–∞–π—Ç–∏ $a^{-1}$ | —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ –º–∞–ª–æ–π —Ç–µ–æ—Ä–µ–º–µ –§–µ—Ä–º–∞ |
| $\varphi(n)$ | —Ñ—É–Ω–∫—Ü–∏—è –≠–π–ª–µ—Ä–∞ | –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∏—Å–µ–ª $< n$, –≤–∑–∞–∏–º–Ω–æ –ø—Ä–æ—Å—Ç—ã—Ö —Å $n$ |
| $g$ | –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π –∫–æ—Ä–µ–Ω—å | $g^k$ –ø—Ä–æ–±–µ–≥–∞–µ—Ç –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã $\mathbb{Z}_p^*$ |
| $\left( \frac{a}{p} \right)$ | —Å–∏–º–≤–æ–ª –õ–µ–∂–∞–Ω–¥—Ä–∞ | $\pm 1$ –∏–ª–∏ $0$, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—ã–π –≤—ã—á–µ—Ç |
| `mod_pow(a, e, p)` | –±—ã—Å—Ç—Ä–æ–µ –≤–æ–∑–≤–µ–¥–µ–Ω–∏–µ –≤ —Å—Ç–µ–ø–µ–Ω—å | $O(\log e)$ |
| `__int128`, `i128` | —Ç–∏–ø –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —É–º–Ω–æ–∂–µ–Ω–∏—è | —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–ø–æ–ª–Ω–∏—Ç—å `long long` |

### –ë—ã—Å—Ç—Ä—ã–µ —Ñ–∞–∫—Ç—ã

| –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ | –§–æ—Ä–º—É–ª–∞/–£—Å–ª–æ–≤–∏–µ | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ |
|-------------|-----------------|------------|
| –ú–∞–ª–∞—è —Ç–µ–æ—Ä–µ–º–∞ –§–µ—Ä–º–∞ | $a^{p-1} \equiv 1 \pmod{p}$ | –û–±—Ä–∞—Ç–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç |
| –¢–µ–æ—Ä–µ–º–∞ –≠–π–ª–µ—Ä–∞ | $a^{\varphi(n)} \equiv 1 \pmod{n}$ | –û–±–æ–±—â–µ–Ω–∏–µ –Ω–∞ —Å–æ—Å—Ç–∞–≤–Ω—ã–µ $n$ |
| –ö—Ä–∏—Ç–µ—Ä–∏–π –≠–π–ª–µ—Ä–∞ | $\left( \frac{a}{p} \right) \equiv a^{(p-1)/2} \pmod{p}$ | –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–≥–æ –≤—ã—á–µ—Ç–∞ |
| –ü—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π –∫–æ—Ä–µ–Ω—å | $\mathbb{Z}_p^* = \{g^1, g^2, ..., g^{p-1}\}$ | –î–∏—Å–∫—Ä–µ—Ç–Ω—ã–π –ª–æ–≥–∞—Ä–∏—Ñ–º, NTT |
| –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã—Ö –∫–æ—Ä–Ω–µ–π | $\varphi(p-1)$ | –ß–∞—Å—Ç–æ –ø–µ—Ä–≤—ã–π –∫–æ—Ä–µ–Ω—å $\leq 10$ |
| –ö–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—ã—Ö –≤—ã—á–µ—Ç–æ–≤ | $(p-1)/2$ | –†–æ–≤–Ω–æ –ø–æ–ª–æ–≤–∏–Ω–∞ –Ω–µ–Ω—É–ª–µ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ |

### –ü—Ä–∏–º–µ—Ä—ã –º–æ–¥—É–ª–µ–π –¥–ª—è CP

| –ú–æ–¥—É–ª—å $p$ | –†–∞–∑–ª–æ–∂–µ–Ω–∏–µ $p-1$ | –ü—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π –∫–æ—Ä–µ–Ω—å $g$ | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ |
|------------|------------------|------------------------|------------|
| $10^9 + 7$ | $2 \cdot 500000003$ | $5$ | –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –º–æ–¥—É–ª—å |
| $998244353$ | $119 \cdot 2^{23} + 1$ | $3$ | NTT (—Å—Ç–µ–ø–µ–Ω—å 2) |
| $1004535809$ | $479 \cdot 2^{21} + 1$ | $3$ | NTT |
| $469762049$ | $7 \cdot 2^{26} + 1$ | $3$ | NTT (–±–æ–ª—å—à–∞—è —Å—Ç–µ–ø–µ–Ω—å) |
| $10^9 + 9$ | $2^3 \cdot 53 \cdot 1572869$ | $13$ | –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ |

### –¢–∞–±–ª–∏—Ü–∞ –º–∞–ª—ã—Ö –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã—Ö –∫–æ—Ä–Ω–µ–π

| $p$ | $p - 1$ | $\varphi(p-1)$ | –ü—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–µ –∫–æ—Ä–Ω–∏ |
|-----|---------|----------------|-------------------|
| 3 | 2 | 1 | 2 |
| 5 | 4 | 2 | 2, 3 |
| 7 | 6 | 2 | 3, 5 |
| 11 | 10 | 4 | 2, 6, 7, 8 |
| 13 | 12 | 4 | 2, 6, 7, 11 |
| 17 | 16 | 8 | 3, 5, 6, 7, 10, 11, 12, 14 |
| 19 | 18 | 6 | 2, 3, 10, 13, 14, 15 |
| 23 | 22 | 10 | 5, 7, 10, 11, 14, 15, 17, 19, 20, 21 |

### –¢–∞–±–ª–∏—Ü–∞ –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—ã—Ö –≤—ã—á–µ—Ç–æ–≤

–î–ª—è $p = 7$: –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—ã–µ –≤—ã—á–µ—Ç—ã ‚Äî $\{1, 2, 4\}$ (–∏–∑ $1^2, 2^2, 3^2 \bmod 7$)

| $a$ | $1$ | $2$ | $3$ | $4$ | $5$ | $6$ |
|-----|-----|-----|-----|-----|-----|-----|
| $a^2 \bmod 7$ | 1 | 4 | 2 | 2 | 4 | 1 |
| $\left( \frac{a}{7} \right)$ | +1 | +1 | -1 | +1 | -1 | -1 |

–î–ª—è $p = 11$: –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—ã–µ –≤—ã—á–µ—Ç—ã ‚Äî $\{1, 3, 4, 5, 9\}$

| $a$ | $1$ | $2$ | $3$ | $4$ | $5$ | $6$ | $7$ | $8$ | $9$ | $10$ |
|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|------|
| $\left( \frac{a}{11} \right)$ | +1 | -1 | +1 | +1 | +1 | -1 | -1 | -1 | +1 | -1 |

---

## –ü–æ–ª–µ $\mathbb{Z}_p$: —á—Ç–æ —ç—Ç–æ –∏ –∑–∞—á–µ–º

–ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ —Ç—ã —Ä–∞–±–æ—Ç–∞–µ—à—å –Ω–µ —Å –æ–±—ã—á–Ω—ã–º–∏ —á–∏—Å–ª–∞–º–∏, –∞ —Å —á–∏—Å–ª–∞–º–∏ **–ø–æ –º–æ–¥—É–ª—é –ø—Ä–æ—Å—Ç–æ–≥–æ —á–∏—Å–ª–∞ $p$**. –≠—Ç–æ –∫–∞–∫ –∑–∞–º–∫–Ω—É—Ç–∞—è –≤—Å–µ–ª–µ–Ω–Ω–∞—è: –≤—Å—ë, —á—Ç–æ —Ç—ã –¥–µ–ª–∞–µ—à—å (—Å–ª–æ–∂–µ–Ω–∏–µ, —É–º–Ω–æ–∂–µ–Ω–∏–µ, –¥–µ–ª–µ–Ω–∏–µ), –æ—Å—Ç–∞—ë—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ $\{0, 1, ..., p-1\}$.

### –ê–ª–≥–µ–±—Ä–∞–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞: –æ—Ç –∫–æ–ª—å—Ü–∞ –∫ –ø–æ–ª—é

–î–∞–≤–∞–π —Ä–∞–∑–±–µ—Ä—ë–º—Å—è, –ø–æ—á–µ–º—É $\mathbb{Z}_p$ ‚Äî —ç—Ç–æ –ø–æ–ª–µ, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ –º–Ω–æ–∂–µ—Å—Ç–≤–æ —á–∏—Å–µ–ª.

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è (–ø—Ä–æ—Å—Ç—ã–º —è–∑—ã–∫–æ–º):**

1. **–ì—Ä—É–ø–ø–∞** ‚Äî –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Å –æ–¥–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–ª–æ–∂–µ–Ω–∏–µ–º), –≥–¥–µ:
   - –ï—Å—Ç—å –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç (0 –¥–ª—è —Å–ª–æ–∂–µ–Ω–∏—è)
   - –£ –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –µ—Å—Ç—å –æ–±—Ä–∞—Ç–Ω—ã–π
   - –û–ø–µ—Ä–∞—Ü–∏—è –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω–∞

2. **–ö–æ–ª—å—Ü–æ** ‚Äî –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Å –¥–≤—É–º—è –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏ (—Å–ª–æ–∂–µ–Ω–∏–µ –∏ —É–º–Ω–æ–∂–µ–Ω–∏–µ), –≥–¥–µ:
   - –ü–æ —Å–ª–æ–∂–µ–Ω–∏—é ‚Äî –∞–±–µ–ª–µ–≤–∞ –≥—Ä—É–ø–ø–∞
   - –£–º–Ω–æ–∂–µ–Ω–∏–µ –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω–æ –∏ –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–Ω–æ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Å–ª–æ–∂–µ–Ω–∏—è
   - –ï—Å—Ç—å –µ–¥–∏–Ω–∏—Ü–∞ (1 –¥–ª—è —É–º–Ω–æ–∂–µ–Ω–∏—è)

3. **–ü–æ–ª–µ** ‚Äî –∫–æ–ª—å—Ü–æ, –≥–¥–µ –∫–∞–∂–¥—ã–π –Ω–µ–Ω—É–ª–µ–≤–æ–π —ç–ª–µ–º–µ–Ω—Ç –∏–º–µ–µ—Ç –æ–±—Ä–∞—Ç–Ω—ã–π –ø–æ —É–º–Ω–æ–∂–µ–Ω–∏—é

### –ü–æ—á–µ–º—É $\mathbb{Z}_p$ ‚Äî –ø–æ–ª–µ?

**–¢–µ–æ—Ä–µ–º–∞:** –ï—Å–ª–∏ $p$ ‚Äî –ø—Ä–æ—Å—Ç–æ–µ, —Ç–æ $\mathbb{Z}_p$ –æ–±—Ä–∞–∑—É–µ—Ç –ø–æ–ª–µ.

**–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ (–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–æ–µ):**

1. **–°–ª–æ–∂–µ–Ω–∏–µ –∏ —É–º–Ω–æ–∂–µ–Ω–∏–µ**: –æ—á–µ–≤–∏–¥–Ω–æ —Ä–∞–±–æ—Ç–∞—é—Ç –ø–æ –º–æ–¥—É–ª—é $p$
2. **–û–±—Ä–∞—Ç–Ω—ã–π –ø–æ —Å–ª–æ–∂–µ–Ω–∏—é**: –¥–ª—è $a$ —ç—Ç–æ $p - a$
3. **–û–±—Ä–∞—Ç–Ω—ã–π –ø–æ —É–º–Ω–æ–∂–µ–Ω–∏—é**: –Ω–∞–¥–æ –ø–æ–∫–∞–∑–∞—Ç—å, —á—Ç–æ –¥–ª—è –ª—é–±–æ–≥–æ $a \in \{1, 2, ..., p-1\}$ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç $a^{-1}$ —Ç–∞–∫–æ–µ, —á—Ç–æ $a \cdot a^{-1} \equiv 1 \pmod{p}$

**–ö–ª—é—á–µ–≤–æ–π –º–æ–º–µ–Ω—Ç:** –ï—Å–ª–∏ $p$ –ø—Ä–æ—Å—Ç–æ–µ –∏ $1 \leq a < p$, —Ç–æ $\gcd(a, p) = 1$. –ü–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–º—É –∞–ª–≥–æ—Ä–∏—Ç–º—É –ï–≤–∫–ª–∏–¥–∞ —Å—É—â–µ—Å—Ç–≤—É—é—Ç $x, y$ —Ç–∞–∫–∏–µ, —á—Ç–æ:
$$ax + py = 1$$

–û—Ç—Å—é–¥–∞:
$$ax \equiv 1 \pmod{p}$$

–ó–Ω–∞—á–∏—Ç, $x$ ‚Äî —ç—Ç–æ –∏ –µ—Å—Ç—å $a^{-1}$! ‚úÖ

**–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ:**
- –î–µ–ª–µ–Ω–∏–µ = —É–º–Ω–æ–∂–µ–Ω–∏–µ –Ω–∞ –æ–±—Ä–∞—Ç–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç
- –ù–µ—Ç –¥–µ–ª–∏—Ç–µ–ª–µ–π –Ω—É–ª—è: –µ—Å–ª–∏ $ab \equiv 0 \pmod{p}$, —Ç–æ –ª–∏–±–æ $a = 0$, –ª–∏–±–æ $b = 0$
- –ú–æ–∂–Ω–æ —Ä–µ—à–∞—Ç—å —É—Ä–∞–≤–Ω–µ–Ω–∏—è –∫–∞–∫ –≤ –æ–±—ã—á–Ω–æ–π –∞–ª–≥–µ–±—Ä–µ!

### –ú—É–ª—å—Ç–∏–ø–ª–∏–∫–∞—Ç–∏–≤–Ω–∞—è –≥—Ä—É–ø–ø–∞ $\mathbb{Z}_p^*$

–û–±–æ–∑–Ω–∞—á–∏–º $\mathbb{Z}_p^* = \{1, 2, ..., p-1\}$ ‚Äî –º–Ω–æ–∂–µ—Å—Ç–≤–æ –Ω–µ–Ω—É–ª–µ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤.

**–¢–µ–æ—Ä–µ–º–∞ (—Ü–∏–∫–ª–∏—á–µ—Å–∫–∞—è –≥—Ä—É–ø–ø–∞):** $\mathbb{Z}_p^*$ ‚Äî —Ü–∏–∫–ª–∏—á–µ—Å–∫–∞—è –≥—Ä—É–ø–ø–∞ –ø–æ—Ä—è–¥–∫–∞ $p-1$.

–≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —ç–ª–µ–º–µ–Ω—Ç $g$ (–ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π –∫–æ—Ä–µ–Ω—å), —Ç–∞–∫–æ–π —á—Ç–æ:
$$\{g^1, g^2, ..., g^{p-1}\} = \{1, 2, ..., p-1\}$$

**–ò–∑–æ–º–æ—Ä—Ñ–∏–∑–º:** –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ $\phi: \mathbb{Z}_{p-1} \to \mathbb{Z}_p^*$ –ø–æ –ø—Ä–∞–≤–∏–ª—É $\phi(k) = g^k$ ‚Äî –∏–∑–æ–º–æ—Ä—Ñ–∏–∑–º –≥—Ä—É–ø–ø!

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ **—É–º–Ω–æ–∂–µ–Ω–∏–µ –≤ $\mathbb{Z}_p^*$ –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ —Å–ª–æ–∂–µ–Ω–∏–µ –≤ $\mathbb{Z}_{p-1}$**. –ò–º–µ–Ω–Ω–æ –Ω–∞ —ç—Ç–æ–º –æ—Å–Ω–æ–≤–∞–Ω –¥–∏—Å–∫—Ä–µ—Ç–Ω—ã–π –ª–æ–≥–∞—Ä–∏—Ñ–º.

```mermaid
graph LR
    A["Z_(p-1) <br/> (—Å–ª–æ–∂–µ–Ω–∏–µ)"] -->|–∏–∑–æ–º–æ—Ä—Ñ–∏–∑–º œÜ| B["Z_p* <br/> (—É–º–Ω–æ–∂–µ–Ω–∏–µ)"]
    A -->|k + m| C["k + m"]
    B -->|g^k ¬∑ g^m| D["g^(k+m)"]
    C -.->|œÜ| D
```

### –ö–∞–∫ –¥–µ–ª–∏—Ç—å ‚Äî —Ç—Ä–∏ —Å–ø–æ—Å–æ–±–∞

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø–æ—Å—á–∏—Ç–∞—Ç—å $\frac{a}{b} \bmod p$:

**–°–ø–æ—Å–æ–± 1: –ú–∞–ª–∞—è —Ç–µ–æ—Ä–µ–º–∞ –§–µ—Ä–º–∞**
```cpp
int64 div_mod(int64 a, int64 b, int64 p) {
    return (i128)a * mod_pow(b, p - 2, p) % p;
}
```
–í—Ä–µ–º—è: $O(\log p)$

**–°–ø–æ—Å–æ–± 2: –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –ï–≤–∫–ª–∏–¥–∞**
```cpp
int64 extended_gcd(int64 a, int64 b, int64& x, int64& y) {
    if (b == 0) {
        x = 1; y = 0;
        return a;
    }
    int64 x1, y1;
    int64 d = extended_gcd(b, a % b, x1, y1);
    x = y1;
    y = x1 - (a / b) * y1;
    return d;
}

int64 mod_inv_egcd(int64 a, int64 p) {
    int64 x, y;
    extended_gcd(a, p, x, y);
    return (x % p + p) % p;
}
```
–í—Ä–µ–º—è: $O(\log \min(a, p))$ ‚Äî –±—ã—Å—Ç—Ä–µ–µ –¥–ª—è –º–∞–ª–µ–Ω—å–∫–∏—Ö $a$!

**–°–ø–æ—Å–æ–± 3: –ü—Ä–µ–¥–ø–æ–¥—Å—á—ë—Ç —Ñ–∞–∫—Ç–æ—Ä–∏–∞–ª–æ–≤**
–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –º–Ω–æ–≥–æ –¥–µ–ª–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –±–∏–Ω–æ–º–∏–∞–ª—å–Ω—ã—Ö –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤):
```cpp
vector<int64> fact(n+1), inv_fact(n+1);

void precompute_factorials(int n, int64 p) {
    fact[0] = 1;
    for (int i = 1; i <= n; ++i)
        fact[i] = (i128)fact[i-1] * i % p;
    
    inv_fact[n] = mod_pow(fact[n], p - 2, p);
    for (int i = n - 1; i >= 0; --i)
        inv_fact[i] = (i128)inv_fact[i+1] * (i + 1) % p;
}

int64 C(int n, int k, int64 p) {
    if (k > n || k < 0) return 0;
    return (i128)fact[n] * inv_fact[k] % p * inv_fact[n-k] % p;
}
```
–ü—Ä–µ–¥–ø–æ–¥—Å—á—ë—Ç: $O(n)$, –∑–∞–ø—Ä–æ—Å: $O(1)$

---

## –ú–Ω–æ–≥–æ—á–ª–µ–Ω—ã –≤ $\mathbb{Z}_p$: –±—ã—Å—Ç—Ä–æ –∏ –±–µ–∑ –ø–∞–Ω–∏–∫–∏

–ú–Ω–æ–≥–æ—á–ª–µ–Ω ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –Ω–∞–±–æ—Ä –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤:  
$$P(x) = a_0 + a_1 x + a_2 x^2 + \cdots + a_n x^n$$

**–í–∞–∂–Ω–æ:** –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç –ø–æ –º–æ–¥—É–ª—é $p$!

### –û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –º–Ω–æ–≥–æ—á–ª–µ–Ω–∞–º–∏

**1. –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è (—Å—Ö–µ–º–∞ –ì–æ—Ä–Ω–µ—Ä–∞)**

–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Å–ø–æ—Å–æ–±: $P(x) = (\cdots((a_n \cdot x + a_{n-1}) \cdot x + a_{n-2}) \cdots + a_1) \cdot x + a_0$

```cpp
// –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã: [a0, a1, a2, ..., an]
int64 eval(const vector<int64>& a, int64 x, int64 p) {
    int64 res = 0;
    for (int i = (int)a.size() - 1; i >= 0; --i)
        res = ((i128)res * x + a[i]) % p;
    return (res % p + p) % p;
}
```

–°–ª–æ–∂–Ω–æ—Å—Ç—å: $O(n)$ (–æ–¥–Ω–æ —É–º–Ω–æ–∂–µ–Ω–∏–µ –∏ —Å–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –∏—Ç–µ—Ä–∞—Ü–∏—é)

**2. –°–ª–æ–∂–µ–Ω–∏–µ –∏ –≤—ã—á–∏—Ç–∞–Ω–∏–µ**

```cpp
vector<int64> add(const vector<int64>& A, const vector<int64>& B, int64 p) {
    int n = max(A.size(), B.size());
    vector<int64> C(n);
    for (int i = 0; i < n; ++i) {
        int64 ai = (i < A.size() ? A[i] : 0);
        int64 bi = (i < B.size() ? B[i] : 0);
        C[i] = (ai + bi) % p;
    }
    return C;
}
```

**3. –£–º–Ω–æ–∂–µ–Ω–∏–µ –º–Ω–æ–≥–æ—á–ª–µ–Ω–æ–≤**

–ù–∞–∏–≤–Ω–æ–µ: $O(n^2)$

```cpp
vector<int64> mul_naive(const vector<int64>& A, const vector<int64>& B, int64 p) {
    if (A.empty() || B.empty()) return {};
    vector<int64> C(A.size() + B.size() - 1);
    for (int i = 0; i < A.size(); ++i)
        for (int j = 0; j < B.size(); ++j)
            C[i+j] = (C[i+j] + (i128)A[i] * B[j]) % p;
    return C;
}
```

–ë—ã—Å—Ç—Ä–æ–µ (NTT): $O(n \log n)$ ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –±–æ–ª—å—à–∏—Ö —Å—Ç–µ–ø–µ–Ω–µ–π!

### –î–µ–ª–µ–Ω–∏–µ –º–Ω–æ–≥–æ—á–ª–µ–Ω–æ–≤ —Å –æ—Å—Ç–∞—Ç–∫–æ–º

**–¢–µ–æ—Ä–µ–º–∞ (–¥–µ–ª–µ–Ω–∏–µ —Å –æ—Å—Ç–∞—Ç–∫–æ–º):** –î–ª—è –ª—é–±—ã—Ö $A(x)$, $B(x) \neq 0$ —Å—É—â–µ—Å—Ç–≤—É—é—Ç **–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–µ** $Q(x)$ –∏ $R(x)$ —Ç–∞–∫–∏–µ, —á—Ç–æ:
$$A(x) = B(x) \cdot Q(x) + R(x), \quad \deg R < \deg B$$

$Q(x)$ ‚Äî —á–∞—Å—Ç–Ω–æ–µ, $R(x)$ ‚Äî –æ—Å—Ç–∞—Ç–æ–∫.

```cpp
// –î–µ–ª–µ–Ω–∏–µ —Å –æ—Å—Ç–∞—Ç–∫–æ–º: A = B*Q + R
pair<vector<int64>, vector<int64>> divmod(vector<int64> A, const vector<int64>& B, int64 p) {
    // –£–±–∏—Ä–∞–µ–º –≤–µ–¥—É—â–∏–µ –Ω—É–ª–∏
    while (!A.empty() && A.back() == 0) A.pop_back();
    vector<int64> B_copy = B;
    while (!B_copy.empty() && B_copy.back() == 0) B_copy.pop_back();
    
    if (B_copy.empty()) throw runtime_error("Division by zero polynomial");
    
    int n = A.size() - 1, m = B_copy.size() - 1;
    if (n < m) return {{0}, A}; // Q = 0, R = A
    
    vector<int64> Q(n - m + 1);
    int64 b_lead_inv = mod_pow(B_copy[m], p - 2, p);
    
    for (int i = n; i >= m; --i) {
        int64 coef = (i128)A[i] * b_lead_inv % p;
        Q[i - m] = coef;
        for (int j = 0; j <= m; ++j)
            A[i - m + j] = (A[i - m + j] - (i128)coef * B_copy[j] % p + p) % p;
    }
    
    A.resize(m);
    return {Q, A};
}
```

### –ù–û–î –º–Ω–æ–≥–æ—á–ª–µ–Ω–æ–≤ (–∞–ª–≥–æ—Ä–∏—Ç–º –ï–≤–∫–ª–∏–¥–∞)

```cpp
vector<int64> gcd_poly(vector<int64> A, vector<int64> B, int64 p) {
    while (!B.empty() && B.back() == 0) B.pop_back();
    while (!B.empty()) {
        auto [Q, R] = divmod(A, B, p);
        A = B;
        B = R;
        while (!B.empty() && B.back() == 0) B.pop_back();
    }
    // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º: —Å—Ç–∞—Ä—à–∏–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç = 1
    if (!A.empty()) {
        int64 lead = A.back();
        int64 inv = mod_pow(lead, p - 2, p);
        for (auto& x : A) x = (i128)x * inv % p;
    }
    return A;
}
```

### –ù–µ–ø—Ä–∏–≤–æ–¥–∏–º—ã–µ –º–Ω–æ–≥–æ—á–ª–µ–Ω—ã

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:** –ú–Ω–æ–≥–æ—á–ª–µ–Ω $P(x)$ —Å—Ç–µ–ø–µ–Ω–∏ $\geq 1$ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **–Ω–µ–ø—Ä–∏–≤–æ–¥–∏–º—ã–º** –Ω–∞–¥ $\mathbb{Z}_p$, –µ—Å–ª–∏ –æ–Ω –Ω–µ —Ä–∞—Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –º–Ω–æ–≥–æ—á–ª–µ–Ω–æ–≤ –º–µ–Ω—å—à–∏—Ö —Å—Ç–µ–ø–µ–Ω–µ–π.

**–ü—Ä–∏–º–µ—Ä—ã:**
- $x^2 + 1$ –Ω–µ–ø—Ä–∏–≤–æ–¥–∏–º –Ω–∞–¥ $\mathbb{Z}_3$ (–ø—Ä–æ–≤–µ—Ä—å: –Ω–µ—Ç –∫–æ—Ä–Ω–µ–π!)
- $x^2 + x + 1$ –Ω–µ–ø—Ä–∏–≤–æ–¥–∏–º –Ω–∞–¥ $\mathbb{Z}_2$

**–ö—Ä–∏—Ç–µ—Ä–∏–π –Ω–µ–ø—Ä–∏–≤–æ–¥–∏–º–æ—Å—Ç–∏ (–¥–ª—è —Å—Ç–µ–ø–µ–Ω–∏ 2 –∏ 3):**

–ú–Ω–æ–≥–æ—á–ª–µ–Ω —Å—Ç–µ–ø–µ–Ω–∏ 2 –∏–ª–∏ 3 –Ω–µ–ø—Ä–∏–≤–æ–¥–∏–º ‚áî —É –Ω–µ–≥–æ –Ω–µ—Ç –∫–æ—Ä–Ω–µ–π –≤ $\mathbb{Z}_p$.

```cpp
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ–ø—Ä–∏–≤–æ–¥–∏–º–æ—Å—Ç–∏ –¥–ª—è —Å—Ç–µ–ø–µ–Ω–∏ ‚â§ 3
bool is_irreducible_small(const vector<int64>& P, int64 p) {
    int n = P.size() - 1;
    if (n > 3) throw runtime_error("Use general test");
    
    // –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –ø–æ–ª—è
    for (int64 x = 0; x < p; ++x)
        if (eval(P, x, p) == 0)
            return false;
    return true;
}
```

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π –ø–æ–ª–µ–π $\mathbb{F}_{p^n} = \mathbb{Z}_p[x] / (P(x))$

### –ò–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è (–õ–∞–≥—Ä–∞–Ω–∂)

–ó–∞–¥–∞—á–∞: –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–Ω–æ–≥–æ—á–ª–µ–Ω —Å—Ç–µ–ø–µ–Ω–∏ $\leq n-1$ –ø–æ $n$ —Ç–æ—á–∫–∞–º $(x_i, y_i)$.

**–§–æ—Ä–º—É–ª–∞ –õ–∞–≥—Ä–∞–Ω–∂–∞:**
$$P(x) = \sum_{i=0}^{n-1} y_i \prod_{j \neq i} \frac{x - x_j}{x_i - x_j}$$

```cpp
vector<int64> lagrange_interpolation(const vector<pair<int64, int64>>& points, int64 p) {
    int n = points.size();
    vector<int64> result(n, 0);
    
    for (int i = 0; i < n; ++i) {
        // –°—Ç—Ä–æ–∏–º –±–∞–∑–∏—Å–Ω—ã–π –º–Ω–æ–≥–æ—á–ª–µ–Ω L_i(x)
        vector<int64> Li = {1};
        int64 denom = 1;
        
        for (int j = 0; j < n; ++j) {
            if (i == j) continue;
            // Li *= (x - x_j)
            vector<int64> factor = {(p - points[j].first) % p, 1};
            Li = mul_naive(Li, factor, p);
            // denom *= (x_i - x_j)
            denom = (i128)denom * ((points[i].first - points[j].first + p) % p) % p;
        }
        
        // Li /= denom
        int64 inv_denom = mod_pow(denom, p - 2, p);
        for (auto& c : Li)
            c = (i128)c * inv_denom % p * points[i].second % p;
        
        result = add(result, Li, p);
    }
    
    return result;
}
```

–°–ª–æ–∂–Ω–æ—Å—Ç—å: $O(n^3)$ (–º–æ–∂–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–æ $O(n^2)$)

---

## –§—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ —Ç–µ–æ—Ä–µ–º—ã ‚Äî –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –∏ –∏–Ω—Ç—É–∏—Ü–∏—è

### –ú–∞–ª–∞—è —Ç–µ–æ—Ä–µ–º–∞ –§–µ—Ä–º–∞

**–¢–µ–æ—Ä–µ–º–∞ (–§–µ—Ä–º–∞):** –ï—Å–ª–∏ $p$ ‚Äî –ø—Ä–æ—Å—Ç–æ–µ –∏ $\gcd(a, p) = 1$, —Ç–æ:
$$a^{p-1} \equiv 1 \pmod{p}$$

**–°–ª–µ–¥—Å—Ç–≤–∏–µ:** $a^p \equiv a \pmod{p}$ –¥–ª—è –ª—é–±–æ–≥–æ $a$.

**–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ 1 (—á–µ—Ä–µ–∑ –≥—Ä—É–ø–ø—É):**

1. –†–∞—Å—Å–º–æ—Ç—Ä–∏–º $\mathbb{Z}_p^* = \{1, 2, ..., p-1\}$ ‚Äî –≥—Ä—É–ø–ø–∞ –ø–æ —É–º–Ω–æ–∂–µ–Ω–∏—é, –ø–æ—Ä—è–¥–∫–∞ $p-1$
2. –ü–æ —Ç–µ–æ—Ä–µ–º–µ –õ–∞–≥—Ä–∞–Ω–∂–∞: –ø–æ—Ä—è–¥–æ–∫ –ª—é–±–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –¥–µ–ª–∏—Ç –ø–æ—Ä—è–¥–æ–∫ –≥—Ä—É–ø–ø—ã
3. –ó–Ω–∞—á–∏—Ç, $a^{p-1} \equiv 1 \pmod{p}$ ‚úÖ

**–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ 2 (–∫–æ–º–±–∏–Ω–∞—Ç–æ—Ä–Ω–æ–µ, –∫—Ä–∞—Å–∏–≤–æ–µ!):**

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –±—É—Å—ã –∏–∑ $p$ –±—É—Å–∏–Ω, –∫–∞–∂–¥–∞—è –æ–∫—Ä–∞—à–µ–Ω–∞ –≤ –æ–¥–∏–Ω –∏–∑ $a$ —Ü–≤–µ—Ç–æ–≤. –í—Å–µ–≥–æ —Ç–∞–∫–∏—Ö –±—É—Å $a^p$.

–†–∞–∑–¥–µ–ª–∏–º –∏—Ö –Ω–∞ –∫–ª–∞—Å—Å—ã —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –ø–æ –ø–æ–≤–æ—Ä–æ—Ç–∞–º. –°–∫–æ–ª—å–∫–æ –±—É—Å –∏–º–µ—é—Ç –ø–µ—Ä–∏–æ–¥ $< p$?

- –ï—Å–ª–∏ –±—É—Å—ã –∏–º–µ—é—Ç –ø–µ—Ä–∏–æ–¥ $d < p$ (–≥–¥–µ $d \mid p$), —Ç–æ $d = 1$ (—Ç–∞–∫ –∫–∞–∫ $p$ –ø—Ä–æ—Å—Ç–æ–µ)
- –ó–Ω–∞—á–∏—Ç, —Ç–æ–ª—å–∫–æ $a$ –æ–¥–Ω–æ—Ü–≤–µ—Ç–Ω—ã—Ö –±—É—Å –∏–º–µ—é—Ç –ø–µ—Ä–∏–æ–¥ $< p$

–í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ $a^p - a$ –±—É—Å –æ–±—Ä–∞–∑—É—é—Ç –∫–ª–∞—Å—Å—ã –ø–æ $p$ —à—Ç—É–∫ (–ø–æ–ª–Ω—ã–π –ø–µ—Ä–∏–æ–¥).

–û—Ç—Å—é–¥–∞: $a^p - a \equiv 0 \pmod{p}$ ‚áí $a^p \equiv a \pmod{p}$ ‚úÖ

### –¢–µ–æ—Ä–µ–º–∞ –≠–π–ª–µ—Ä–∞ (–æ–±–æ–±—â–µ–Ω–∏–µ)

**–¢–µ–æ—Ä–µ–º–∞ (–≠–π–ª–µ—Ä):** –ï—Å–ª–∏ $\gcd(a, n) = 1$, —Ç–æ:
$$a^{\varphi(n)} \equiv 1 \pmod{n}$$

–≥–¥–µ $\varphi(n)$ ‚Äî —Ñ—É–Ω–∫—Ü–∏—è –≠–π–ª–µ—Ä–∞ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∏—Å–µ–ª $< n$, –≤–∑–∞–∏–º–Ω–æ –ø—Ä–æ—Å—Ç—ã—Ö —Å $n$).

**–°–ª–µ–¥—Å—Ç–≤–∏–µ:** –î–ª—è $n = p$ (–ø—Ä–æ—Å—Ç–æ–µ) –ø–æ–ª—É—á–∞–µ–º $\varphi(p) = p-1$ ‚Üí –º–∞–ª–∞—è —Ç–µ–æ—Ä–µ–º–∞ –§–µ—Ä–º–∞.

**–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**
```cpp
// –û–±—Ä–∞—Ç–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è —Å–æ—Å—Ç–∞–≤–Ω–æ–≥–æ –º–æ–¥—É–ª—è
int64 mod_inv_euler(int64 a, int64 n) {
    int64 phi = euler_phi(n); // –≤—ã—á–∏—Å–ª–∏—Ç—å œÜ(n)
    return mod_pow(a, phi - 1, n);
}

// –ë—ã—Å—Ç—Ä–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ œÜ(n)
int64 euler_phi(int64 n) {
    int64 result = n;
    for (int64 p = 2; p * p <= n; ++p) {
        if (n % p == 0) {
            while (n % p == 0) n /= p;
            result -= result / p;
        }
    }
    if (n > 1) result -= result / n;
    return result;
}
```

---

## –ü—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–µ (–ø–µ—Ä–≤–æ–æ–±—Ä–∞–∑–Ω—ã–µ) –∫–æ—Ä–Ω–∏ ‚Äî –∫—Ç–æ –æ–Ω–∏ –∏ –∑–∞—á–µ–º –Ω—É–∂–Ω—ã

**–ü—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π –∫–æ—Ä–µ–Ω—å –ø–æ –º–æ–¥—É–ª—é $p$** ‚Äî —ç—Ç–æ —Ç–∞–∫–æ–µ —á–∏—Å–ª–æ $g$, —á—Ç–æ –µ–≥–æ —Å—Ç–µ–ø–µ–Ω–∏ –¥–∞—é—Ç **–≤—Å–µ –Ω–µ–Ω—É–ª–µ–≤—ã–µ –≤—ã—á–µ—Ç—ã**:

$$
g^1, g^2, ..., g^{p-1} \equiv 1, 2, ..., p-1 \pmod p \quad (\text{–≤ –∫–∞–∫–æ–º-—Ç–æ –ø–æ—Ä—è–¥–∫–µ})
$$

–î—Ä—É–≥–∏–º–∏ —Å–ª–æ–≤–∞–º–∏: **–ø–æ—Ä—è–¥–æ–∫** $g$ (–º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ $k > 0$ —Ç–∞–∫–æ–µ, —á—Ç–æ $g^k \equiv 1$) —Ä–∞–≤–µ–Ω $p-1$.

### –¢–µ–æ—Ä–µ–º–∞ –æ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–∏

**–¢–µ–æ—Ä–µ–º–∞:** –î–ª—è –ª—é–±–æ–≥–æ –ø—Ä–æ—Å—Ç–æ–≥–æ $p$ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π –∫–æ—Ä–µ–Ω—å.

**–≠—Å–∫–∏–∑ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞:**

1. –ü—É—Å—Ç—å $p - 1 = q_1^{e_1} \cdots q_k^{e_k}$ ‚Äî —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –ø—Ä–æ—Å—Ç—ã–µ
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ $q_i^{e_i}$ –Ω–∞–π–¥—ë–º $g_i$ —Ç–∞–∫–æ–µ, —á—Ç–æ $g_i^{(p-1)/q_i} \not\equiv 1$
3. –¢–æ–≥–¥–∞ $g = g_1 \cdot g_2 \cdots g_k$ ‚Äî –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π –∫–æ—Ä–µ–Ω—å!

**–ü–æ—á–µ–º—É?** –ü–æ—Ä—è–¥–æ–∫ $g$ –¥–µ–ª–∏—Ç—Å—è –Ω–∞ –≤—Å–µ $q_i^{e_i}$ ‚áí –ø–æ—Ä—è–¥–æ–∫ = $p-1$ ‚úÖ

### –°–∫–æ–ª—å–∫–æ –∏—Ö?

**–¢–µ–æ—Ä–µ–º–∞:** –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã—Ö –∫–æ—Ä–Ω–µ–π –ø–æ –º–æ–¥—É–ª—é $p$ —Ä–∞–≤–Ω–æ $\varphi(p-1)$.

**–ü–æ—á–µ–º—É?** –ï—Å–ª–∏ $g$ ‚Äî –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π –∫–æ—Ä–µ–Ω—å, —Ç–æ $g^k$ —Ç–æ–∂–µ –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π –∫–æ—Ä–µ–Ω—å —Ç–æ–≥–¥–∞ –∏ —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ $\gcd(k, p-1) = 1$.

**–ü—Ä–∏–º–µ—Ä—ã:**
- $p = 7$: $p - 1 = 6$, $\varphi(6) = 2$ ‚Üí –µ—Å—Ç—å 2 –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã—Ö –∫–æ—Ä–Ω—è (—ç—Ç–æ 3 –∏ 5)
- $p = 11$: $p - 1 = 10$, $\varphi(10) = 4$ ‚Üí –µ—Å—Ç—å 4 –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã—Ö –∫–æ—Ä–Ω—è (2, 6, 7, 8)

```mermaid
graph TD
    A["–ì—Ä—É–ø–ø–∞ Z_p* <br/> –ø–æ—Ä—è–¥–∫–∞ p-1"] --> B["–ü—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π –∫–æ—Ä–µ–Ω—å g"]
    B --> C["g^1, g^2, ..., g^(p-1)"]
    C --> D["–í—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã Z_p*!"]
    B --> E["–î—Ä—É–≥–∏—Ö –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã—Ö –∫–æ—Ä–Ω–µ–π: œÜ(p-1)"]
```

### –ó–∞—á–µ–º –æ–Ω–∏ –Ω—É–∂–Ω—ã?

**1. –î–∏—Å–∫—Ä–µ—Ç–Ω—ã–π –ª–æ–≥–∞—Ä–∏—Ñ–º**

–ó–∞–¥–∞—á–∞: –ø–æ –∏–∑–≤–µ—Å—Ç–Ω—ã–º $g$, $h$ –∏ $p$ –Ω–∞–π—Ç–∏ $x$ —Ç–∞–∫–æ–π, —á—Ç–æ $g^x \equiv h \pmod{p}$.

–ê–ª–≥–æ—Ä–∏—Ç–º **Baby-step Giant-step** (–®—ç–Ω–∫—Å, 1971):

```cpp
// –ù–∞—Ö–æ–¥–∏—Ç x: g^x ‚â° h (mod p)
// –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç -1, –µ—Å–ª–∏ —Ä–µ—à–µ–Ω–∏—è –Ω–µ—Ç
int64 discrete_log(int64 g, int64 h, int64 p) {
    int64 m = (int64)sqrt(p) + 1;
    
    // Baby step: —Å—á–∏—Ç–∞–µ–º g^0, g^1, ..., g^(m-1)
    unordered_map<int64, int64> table;
    int64 cur = 1;
    for (int64 i = 0; i < m; ++i) {
        table[cur] = i;
        cur = (i128)cur * g % p;
    }
    
    // Giant step: –ø—Ä–æ–≤–µ—Ä—è–µ–º h ¬∑ (g^(-m))^j
    int64 g_inv_m = mod_pow(g, p - 1 - m, p); // g^(-m)
    cur = h;
    for (int64 j = 0; j < m; ++j) {
        if (table.count(cur))
            return j * m + table[cur];
        cur = (i128)cur * g_inv_m % p;
    }
    
    return -1;
}
```

–°–ª–æ–∂–Ω–æ—Å—Ç—å: $O(\sqrt{p})$ –≤—Ä–µ–º–µ–Ω–∏ –∏ –ø–∞–º—è—Ç–∏.

**–ò–¥–µ—è:** –ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º $x = jm + i$, –≥–¥–µ $m = \lceil \sqrt{p} \rceil$. –¢–æ–≥–¥–∞:
$$g^x = g^{jm + i} \equiv h \pmod{p}$$
$$g^i \equiv h \cdot (g^{-m})^j \pmod{p}$$

**2. NTT (Number Theoretic Transform)**

–î–ª—è $p = c \cdot 2^k + 1$ (–ø—Ä–æ—Å—Ç–æ–µ) —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π –∫–æ—Ä–µ–Ω—å $g$ —Ç–∞–∫–æ–π, —á—Ç–æ $g^{2^k}$ ‚Äî –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π –∫–æ—Ä–µ–Ω—å —Å—Ç–µ–ø–µ–Ω–∏ $2^k$.

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –±—ã—Å—Ç—Ä–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ –º–Ω–æ–≥–æ—á–ª–µ–Ω–æ–≤ –∑–∞ $O(n \log n)$.

**–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –º–æ–¥—É–ª–∏ –¥–ª—è NTT:**

| –ú–æ–¥—É–ª—å $p$ | –†–∞–∑–ª–æ–∂–µ–Ω–∏–µ | $g$ | –ú–∞–∫—Å. —Å—Ç–µ–ø–µ–Ω—å |
|------------|------------|-----|---------------|
| $998244353$ | $119 \cdot 2^{23} + 1$ | $3$ | $2^{23}$ |
| $1004535809$ | $479 \cdot 2^{21} + 1$ | $3$ | $2^{21}$ |
| $469762049$ | $7 \cdot 2^{26} + 1$ | $3$ | $2^{26}$ |

### –°–≤–æ–π—Å—Ç–≤–∞ –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã—Ö –∫–æ—Ä–Ω–µ–π

**–°–≤–æ–π—Å—Ç–≤–æ 1:** –ï—Å–ª–∏ $g$ ‚Äî –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π –∫–æ—Ä–µ–Ω—å, —Ç–æ $g^k$ ‚Äî —Ç–æ–∂–µ –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π –∫–æ—Ä–µ–Ω—å ‚áî $\gcd(k, p-1) = 1$.

**–°–≤–æ–π—Å—Ç–≤–æ 2:** –ü–µ—Ä–≤—ã–π –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π –∫–æ—Ä–µ–Ω—å –æ–±—ã—á–Ω–æ –º–∞–ª (—á–∞—Å—Ç–æ 2, 3, 5).

**–°–≤–æ–π—Å—Ç–≤–æ 3:** –ï—Å–ª–∏ $g$ ‚Äî –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π –∫–æ—Ä–µ–Ω—å, —Ç–æ:
- $g^{(p-1)/2} \equiv -1 \pmod{p}$ (–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –ø–æ—Ä—è–¥–∫–∞ 2)
- $g^{k}$ ‚Äî –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—ã–π –≤—ã—á–µ—Ç ‚áî $k$ —á—ë—Ç–Ω–æ

---

## –ö–∞–∫ –∏—Å–∫–∞—Ç—å –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π –∫–æ—Ä–µ–Ω—å?

–ò–¥–µ—è:  
–ü—É—Å—Ç—å $p-1 = q_1^{e_1} q_2^{e_2} \dots q_k^{e_k}$ ‚Äî —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –ø—Ä–æ—Å—Ç—ã–µ.  
–¢–æ–≥–¥–∞ $g$ ‚Äî –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π –∫–æ—Ä–µ–Ω—å **—Ç–æ–≥–¥–∞ –∏ —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞**, –∫–æ–≥–¥–∞:

$$
g^{(p-1)/q_i} \not\equiv 1 \pmod p \quad \text{–¥–ª—è –≤—Å–µ—Ö } i
$$

–ü–æ—á–µ–º—É? –ü–æ—Ç–æ–º—É —á—Ç–æ –µ—Å–ª–∏ $g^{(p-1)/q} \equiv 1$, —Ç–æ –ø–æ—Ä—è–¥–æ–∫ $g$ –¥–µ–ª–∏—Ç $(p-1)/q$ ‚Üí –æ–Ω **–º–µ–Ω—å—à–µ** $p-1$ ‚Üí –Ω–µ –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π.

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

```cpp
vector<int64> prime_factors(int64 n) {
    vector<int64> f;
    for (int64 p = 2; p * p <= n; ++p) {
        if (n % p == 0) {
            f.push_back(p);
            while (n % p == 0) n /= p;
        }
    }
    if (n > 1) f.push_back(n);
    return f;
}

int64 find_primitive_root(int64 p) {
    if (p == 2) return 1;
    auto primes = prime_factors(p - 1);
    for (int64 g = 2; g < p; ++g) {
        bool ok = true;
        for (int64 q : primes)
            if (mod_pow(g, (p - 1) / q, p) == 1) { ok = false; break; }
        if (ok) return g;
    }
    return -1; // –Ω–µ –¥–æ–ª–∂–Ω–æ —Å–ª—É—á–∏—Ç—å—Å—è
}
```

> üí° –ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ –ø–µ—Ä–µ–±–æ—Ä –¥–æ 10 –ø–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ –Ω–∞—Ö–æ–¥–∏—Ç –∫–æ—Ä–µ–Ω—å.

---

## –ö–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è –≤ $\mathbb{Z}_p$

–†–µ—à–∞–µ–º:  
$$ax^2 + bx + c \equiv 0 \pmod p$$

### –®–∞–≥ 1: –ü—Ä–∏–≤–µ—Å—Ç–∏ –∫ –≤–∏–¥—É $x^2 + Bx + C = 0$
–ï—Å–ª–∏ $a \ne 0$, –¥–æ–º–Ω–æ–∂–∞–µ–º –Ω–∞ $a^{-1}$:
```cpp
int64 inv_a = mod_inv(a, p);
int64 B = (i128)b * inv_a % p;
int64 C = (i128)c * inv_a % p;
```

### –®–∞–≥ 2: –°—á–∏—Ç–∞–µ–º –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞–Ω—Ç
$`
D = B^2 - 4C \pmod p
`$

–¢–µ–ø–µ—Ä—å –≤—Å—ë –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–æ–≥–æ, **–µ—Å—Ç—å –ª–∏ —É $D$ –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–π –∫–æ—Ä–µ–Ω—å –ø–æ –º–æ–¥—É–ª—é $p$**.

---

## –°–∏–º–≤–æ–ª –õ–µ–∂–∞–Ω–¥—Ä–∞ –∏ –∫—Ä–∏—Ç–µ—Ä–∏–π –≠–π–ª–µ—Ä–∞

**–°–∏–º–≤–æ–ª –õ–µ–∂–∞–Ω–¥—Ä–∞** –≥–æ–≤–æ—Ä–∏—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —á–∏—Å–ª–æ –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—ã–º –≤—ã—á–µ—Ç–æ–º:

$$
\left( \frac{a}{p} \right) =
\begin{cases}
0, & a \equiv 0 \pmod p \\
1, & \exists x: x^2 \equiv a \pmod p \\
-1, & \text{–∏–Ω–∞—á–µ}
\end{cases}
$$

**–ö—Ä–∏—Ç–µ—Ä–∏–π –≠–π–ª–µ—Ä–∞** (–∫–∞–∫ –ø–æ—Å—á–∏—Ç–∞—Ç—å):
$$\left( \frac{a}{p} \right) \equiv a^{(p-1)/2} \pmod p$$

**–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ –∫—Ä–∏—Ç–µ—Ä–∏—è –≠–π–ª–µ—Ä–∞:**

1. –ï—Å–ª–∏ $a \equiv 0$, —Ç–æ $a^{(p-1)/2} \equiv 0$ ‚úÖ
2. –ü—É—Å—Ç—å $a \not\equiv 0$. –¢–æ–≥–¥–∞ $a^{p-1} \equiv 1$ (–º–∞–ª–∞—è —Ç–µ–æ—Ä–µ–º–∞ –§–µ—Ä–º–∞)
3. –ó–Ω–∞—á–∏—Ç, $a^{(p-1)/2}$ ‚Äî –∫–æ—Ä–µ–Ω—å –∏–∑ 1 ‚áí $a^{(p-1)/2} \in \{1, -1\}$
4. –ï—Å–ª–∏ $a = x^2$, —Ç–æ $a^{(p-1)/2} = x^{p-1} \equiv 1$ ‚úÖ
5. –û—Å—Ç–∞–ª–æ—Å—å –¥–æ–∫–∞–∑–∞—Ç—å, —á—Ç–æ —Ä–æ–≤–Ω–æ $(p-1)/2$ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–∞—é—Ç $+1$

**–ü–æ—á–µ–º—É —Ä–æ–≤–Ω–æ –ø–æ–ª–æ–≤–∏–Ω–∞ ‚Äî –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—ã–µ –≤—ã—á–µ—Ç—ã?**

–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ $x \mapsto x^2$ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç $\mathbb{Z}_p^*$ –≤ –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—ã–µ –≤—ã—á–µ—Ç—ã. –ü—Ä–∏ —ç—Ç–æ–º $x^2 = (-x)^2$, –∑–Ω–∞—á–∏—Ç, –∫–∞–∂–¥—ã–π –≤—ã—á–µ—Ç –ø–æ–ª—É—á–∞–µ—Ç—Å—è –∏–∑ –¥–≤—É—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ ‚áí –≤—Å–µ–≥–æ –≤—ã—á–µ—Ç–æ–≤ $(p-1)/2$ ‚úÖ

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

```cpp
int legendre(int64 a, int64 p) {
    a %= p;
    if (a < 0) a += p;
    if (a == 0) return 0;
    int64 r = mod_pow(a, (p - 1) / 2, p);
    return (r == 1) ? 1 : -1;
}
```

### –°–≤–æ–π—Å—Ç–≤–∞ —Å–∏–º–≤–æ–ª–∞ –õ–µ–∂–∞–Ω–¥—Ä–∞

**1. –ú—É–ª—å—Ç–∏–ø–ª–∏–∫–∞—Ç–∏–≤–Ω–æ—Å—Ç—å:**
$$\left( \frac{ab}{p} \right) = \left( \frac{a}{p} \right) \left( \frac{b}{p} \right)$$

**2. –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:**
$$\left( \frac{-1}{p} \right) = (-1)^{(p-1)/2} = \begin{cases} 1, & p \equiv 1 \pmod{4} \\ -1, & p \equiv 3 \pmod{4} \end{cases}$$

$$\left( \frac{2}{p} \right) = (-1)^{(p^2-1)/8} = \begin{cases} 1, & p \equiv \pm 1 \pmod{8} \\ -1, & p \equiv \pm 3 \pmod{8} \end{cases}$$

**3. –ö–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—ã–π –∑–∞–∫–æ–Ω –≤–∑–∞–∏–º–Ω–æ—Å—Ç–∏ (–ì–∞—É—Å—Å):**

–î–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –Ω–µ—á—ë—Ç–Ω—ã—Ö –ø—Ä–æ—Å—Ç—ã—Ö $p$ –∏ $q$:
$$\left( \frac{p}{q} \right) \left( \frac{q}{p} \right) = (-1)^{(p-1)(q-1)/4}$$

–ò–ª–∏ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ:
$$\left( \frac{p}{q} \right) = \begin{cases} 
\left( \frac{q}{p} \right), & \text{–µ—Å–ª–∏ } p \equiv 1 \pmod{4} \text{ –∏–ª–∏ } q \equiv 1 \pmod{4} \\
-\left( \frac{q}{p} \right), & \text{–µ—Å–ª–∏ } p \equiv q \equiv 3 \pmod{4}
\end{cases}$$

**–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ –≤—ã—á–∏—Å–ª—è—Ç—å —Å–∏–º–≤–æ–ª –õ–µ–∂–∞–Ω–¥—Ä–∞ –±–µ–∑ –≤–æ–∑–≤–µ–¥–µ–Ω–∏—è –≤ —Å—Ç–µ–ø–µ–Ω—å!

### –ë—ã—Å—Ç—Ä–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å–∏–º–≤–æ–ª–∞ –õ–µ–∂–∞–Ω–¥—Ä–∞

–ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—ã–π –∑–∞–∫–æ–Ω –≤–∑–∞–∏–º–Ω–æ—Å—Ç–∏ (–∞–Ω–∞–ª–æ–≥ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –ï–≤–∫–ª–∏–¥–∞):

```cpp
// –ë—ã—Å—Ç—Ä—ã–π —Å–∏–º–≤–æ–ª –õ–µ–∂–∞–Ω–¥—Ä–∞ —á–µ—Ä–µ–∑ –∑–∞–∫–æ–Ω –≤–∑–∞–∏–º–Ω–æ—Å—Ç–∏
int legendre_fast(int64 a, int64 p) {
    a %= p;
    if (a < 0) a += p;
    
    int result = 1;
    while (a != 0) {
        // –£–±–∏—Ä–∞–µ–º —Å—Ç–µ–ø–µ–Ω–∏ –¥–≤–æ–π–∫–∏
        while (a % 2 == 0) {
            a /= 2;
            // (2/p) = -1 –µ—Å–ª–∏ p ‚â° ¬±3 (mod 8)
            if (p % 8 == 3 || p % 8 == 5)
                result = -result;
        }
        
        // –ü—Ä–∏–º–µ–Ω—è–µ–º –∑–∞–∫–æ–Ω –≤–∑–∞–∏–º–Ω–æ—Å—Ç–∏
        if (a % 4 == 3 && p % 4 == 3)
            result = -result;
        
        swap(a, p);
        a %= p;
    }
    
    return (p == 1) ? result : 0;
}
```

–°–ª–æ–∂–Ω–æ—Å—Ç—å: $O(\log \min(a, p))$ ‚Äî –∫–∞–∫ –∞–ª–≥–æ—Ä–∏—Ç–º –ï–≤–∫–ª–∏–¥–∞!

### –°–∏–º–≤–æ–ª –Ø–∫–æ–±–∏ (–æ–±–æ–±—â–µ–Ω–∏–µ)

–î–ª—è —Å–æ—Å—Ç–∞–≤–Ω–æ–≥–æ $n = p_1^{e_1} \cdots p_k^{e_k}$:
$$\left( \frac{a}{n} \right) = \prod_{i=1}^{k} \left( \frac{a}{p_i} \right)^{e_i}$$

**–í–∞–∂–Ω–æ:** $\left( \frac{a}{n} \right) = 1$ –ù–ï –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ $x^2 \equiv a \pmod{n}$ –∏–º–µ–µ—Ç —Ä–µ—à–µ–Ω–∏–µ!

```cpp
// –°–∏–º–≤–æ–ª –Ø–∫–æ–±–∏ (—Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è —Å–æ—Å—Ç–∞–≤–Ω—ã—Ö n)
int jacobi(int64 a, int64 n) {
    if (n <= 0 || n % 2 == 0) throw runtime_error("n must be odd and positive");
    
    a %= n;
    if (a < 0) a += n;
    
    int result = 1;
    while (a != 0) {
        while (a % 2 == 0) {
            a /= 2;
            if (n % 8 == 3 || n % 8 == 5)
                result = -result;
        }
        
        if (a % 4 == 3 && n % 4 == 3)
            result = -result;
        
        swap(a, n);
        a %= n;
    }
    
    return (n == 1) ? result : 0;
}
```

### –ü—Ä–∏–º–µ—Ä—ã –≤—ã—á–∏—Å–ª–µ–Ω–∏–π

**–ü—Ä–∏–º–µ—Ä 1:** –í—ã—á–∏—Å–ª–∏–º $\left( \frac{15}{23} \right)$

$$\left( \frac{15}{23} \right) = \left( \frac{3 \cdot 5}{23} \right) = \left( \frac{3}{23} \right) \left( \frac{5}{23} \right)$$

–ü–æ –∑–∞–∫–æ–Ω—É –≤–∑–∞–∏–º–Ω–æ—Å—Ç–∏ ($3 \equiv 3 \pmod{4}$, $23 \equiv 3 \pmod{4}$):
$$\left( \frac{3}{23} \right) = -\left( \frac{23}{3} \right) = -\left( \frac{2}{3} \right) = -(-1) = 1$$

–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ ($5 \equiv 1 \pmod{4}$):
$$\left( \frac{5}{23} \right) = \left( \frac{23}{5} \right) = \left( \frac{3}{5} \right) = \left( \frac{5}{3} \right) = \left( \frac{2}{3} \right) = -1$$

–ò—Ç–æ–≥–æ: $\left( \frac{15}{23} \right) = 1 \cdot (-1) = -1$ ‚áí 15 –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—ã–º –≤—ã—á–µ—Ç–æ–º –ø–æ –º–æ–¥—É–ª—é 23.

**–ü—Ä–∏–º–µ—Ä 2:** –î–ª—è –∫–∞–∫–∏—Ö –ø—Ä–æ—Å—Ç—ã—Ö $p$ —á–∏—Å–ª–æ 3 —è–≤–ª—è–µ—Ç—Å—è –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—ã–º –≤—ã—á–µ—Ç–æ–º?

–ü–æ –∑–∞–∫–æ–Ω—É –≤–∑–∞–∏–º–Ω–æ—Å—Ç–∏:
$$\left( \frac{3}{p} \right) = \begin{cases}
\left( \frac{p}{3} \right), & p \equiv 1 \pmod{4} \\
-\left( \frac{p}{3} \right), & p \equiv 3 \pmod{4}
\end{cases}$$

$\left( \frac{p}{3} \right) = 1$ ‚áî $p \equiv 1 \pmod{3}$

–ò—Ç–æ–≥–æ:
- –ï—Å–ª–∏ $p \equiv 1 \pmod{4}$ –∏ $p \equiv 1 \pmod{3}$ ‚áí $p \equiv 1 \pmod{12}$
- –ï—Å–ª–∏ $p \equiv 3 \pmod{4}$ –∏ $p \equiv 2 \pmod{3}$ ‚áí $p \equiv 11 \pmod{12}$

**–û—Ç–≤–µ—Ç:** $\left( \frac{3}{p} \right) = 1$ ‚áî $p \equiv \pm 1 \pmod{12}$

---

## –ê–ª–≥–æ—Ä–∏—Ç–º –¢–æ–Ω–µ–ª–ª–∏‚Äì–®–µ–Ω–∫—Å–∞ ‚Äî –∫–∞–∫ –∏–∑–≤–ª–µ—á—å –∫–æ—Ä–µ–Ω—å –ø–æ –º–æ–¥—É–ª—é

–ï—Å–ª–∏ $\left( \frac{a}{p} \right) = 1$, —Ç–æ –∫–æ—Ä–µ–Ω—å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –ù–æ –∫–∞–∫ –µ–≥–æ –Ω–∞–π—Ç–∏?

–ü–µ—Ä–µ–±–æ—Ä (`for x in 1..p`) —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è –º–∞–ª–µ–Ω—å–∫–∏—Ö $p$. –î–ª—è –±–æ–ª—å—à–∏—Ö ‚Äî **–¢–æ–Ω–µ–ª–ª–∏‚Äì–®–µ–Ω–∫—Å**.

### –ö–∞–∫ –æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç (–∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ)?
- –†–∞—Å–∫–ª–∞–¥—ã–≤–∞–µ–º $p-1 = q \cdot 2^s$.
- –ù–∞—Ö–æ–¥–∏–º ¬´–Ω–µ–∫–≤–∞–¥—Ä–∞—Ç¬ª $z$ (—Å–∏–º–≤–æ–ª –õ–µ–∂–∞–Ω–¥—Ä–∞ = -1).
- –ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ —É–ª—É—á—à–∞–µ–º –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ –∫ –∫–æ—Ä–Ω—é, –∏—Å–ø–æ–ª—å–∑—É—è —Å—Ç–µ–ø–µ–Ω–∏ $z$.

### –ö–æ–¥ (—Ä–∞–±–æ—á–∏–π, –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–π)

```cpp
int64 tonelli_shanks(int64 a, int64 p) {
    if (a == 0) return 0;
    if (p == 2) return a;
    if (legendre(a, p) != 1) return -1;

    int64 q = p - 1, s = 0;
    while ((q & 1) == 0) { q >>= 1; ++s; }

    if (s == 1) return mod_pow(a, (p + 1) / 4, p);

    int64 z = 2;
    while (legendre(z, p) != -1) ++z;

    int64 c = mod_pow(z, q, p);
    int64 r = mod_pow(a, (q + 1) / 2, p);
    int64 t = mod_pow(a, q, p);
    int64 m = s;

    while (t != 1) {
        int64 i = 0, tt = t;
        while (tt != 1) {
            tt = (i128)tt * tt % p;
            ++i;
            if (i == m) return -1;
        }
        int64 b = mod_pow(c, 1LL << (m - i - 1), p);
        r = (i128)r * b % p;
        c = (i128)b * b % p;
        t = (i128)t * c % p;
        m = i;
    }
    return r;
}
```

> üí° –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–¥–∏–Ω –∏–∑ –∫–æ—Ä–Ω–µ–π. –í—Ç–æ—Ä–æ–π ‚Äî —ç—Ç–æ `p - r`.

---

## –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏ –∏ –ø–∞—Ç—Ç–µ—Ä–Ω—ã —Ä–µ—à–µ–Ω–∏–π

### –ó–∞–¥–∞—á–∞ 1: –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –±–∏–Ω–æ–º–∏–∞–ª—å–Ω—ã—Ö –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤

**–£—Å–ª–æ–≤–∏–µ:** –í—ã—á–∏—Å–ª–∏—Ç—å $\binom{n}{k} \bmod p$ –¥–ª—è $n, k \leq 10^6$, $p = 10^9 + 7$.

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–µ–¥–ø–æ–¥—Å—á—ë—Ç —Ñ–∞–∫—Ç–æ—Ä–∏–∞–ª–æ–≤ + –æ–±—Ä–∞—Ç–Ω—ã–µ —á–µ—Ä–µ–∑ –§–µ—Ä–º–∞.

```cpp
const int64 MOD = 1e9 + 7;
const int MAXN = 1e6;

vector<int64> fact(MAXN + 1), inv_fact(MAXN + 1);

void precompute() {
    fact[0] = 1;
    for (int i = 1; i <= MAXN; ++i)
        fact[i] = (i128)fact[i-1] * i % MOD;
    
    inv_fact[MAXN] = mod_pow(fact[MAXN], MOD - 2, MOD);
    for (int i = MAXN - 1; i >= 0; --i)
        inv_fact[i] = (i128)inv_fact[i+1] * (i + 1) % MOD;
}

int64 C(int n, int k) {
    if (k > n || k < 0) return 0;
    return (i128)fact[n] * inv_fact[k] % MOD * inv_fact[n-k] % MOD;
}

int main() {
    precompute();
    cout << C(1000000, 500000) << '\n'; // –º–≥–Ω–æ–≤–µ–Ω–Ω–æ!
}
```

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –ü—Ä–µ–¥–ø–æ–¥—Å—á—ë—Ç $O(n)$, –∑–∞–ø—Ä–æ—Å $O(1)$.

---

### –ó–∞–¥–∞—á–∞ 2: –†–µ—à–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –ª–∏–Ω–µ–π–Ω—ã—Ö —É—Ä–∞–≤–Ω–µ–Ω–∏–π

**–£—Å–ª–æ–≤–∏–µ:** –†–µ—à–∏—Ç—å $Ax = b$ –ø–æ –º–æ–¥—É–ª—é $p$, –≥–¥–µ $A$ ‚Äî –º–∞—Ç—Ä–∏—Ü–∞ $n \times n$.

**–†–µ—à–µ–Ω–∏–µ:** –ú–µ—Ç–æ–¥ –ì–∞—É—Å—Å–∞ —Å –º–æ–¥—É–ª—å–Ω–æ–π –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–æ–π.

```cpp
// –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ—à–µ–Ω–∏–µ –∏–ª–∏ –ø—É—Å—Ç–æ–π –≤–µ–∫—Ç–æ—Ä, –µ—Å–ª–∏ —Å–∏—Å—Ç–µ–º—ã –Ω–µ—Å–æ–≤–º–µ—Å—Ç–Ω–∞
vector<int64> solve_linear_system(vector<vector<int64>> A, vector<int64> b, int64 p) {
    int n = A.size();
    
    // –ü—Ä—è–º–æ–π —Ö–æ–¥
    for (int col = 0, row = 0; col < n && row < n; ++col) {
        // –ò—â–µ–º –Ω–µ–Ω—É–ª–µ–≤–æ–π —ç–ª–µ–º–µ–Ω—Ç
        int pivot = row;
        for (int i = row + 1; i < n; ++i)
            if (A[i][col] % p != 0) { pivot = i; break; }
        
        if (A[pivot][col] % p == 0) continue; // —Å—Ç–æ–ª–±–µ—Ü –Ω—É–ª–µ–≤–æ–π
        
        swap(A[row], A[pivot]);
        swap(b[row], b[pivot]);
        
        // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º —Å—Ç—Ä–æ–∫—É
        int64 inv = mod_pow(A[row][col], p - 2, p);
        for (int j = col; j < n; ++j)
            A[row][j] = (i128)A[row][j] * inv % p;
        b[row] = (i128)b[row] * inv % p;
        
        // –û–±–Ω—É–ª—è–µ–º —Å—Ç–æ–ª–±–µ—Ü –Ω–∏–∂–µ
        for (int i = row + 1; i < n; ++i) {
            int64 factor = A[i][col];
            for (int j = col; j < n; ++j)
                A[i][j] = (A[i][j] - (i128)factor * A[row][j] % p + p) % p;
            b[i] = (b[i] - (i128)factor * b[row] % p + p) % p;
        }
        
        ++row;
    }
    
    // –û–±—Ä–∞—Ç–Ω—ã–π —Ö–æ–¥
    vector<int64> x(n, 0);
    for (int i = n - 1; i >= 0; --i) {
        x[i] = b[i];
        for (int j = i + 1; j < n; ++j)
            x[i] = (x[i] - (i128)A[i][j] * x[j] % p + p) % p;
        if (A[i][i] != 1) x[i] = (i128)x[i] * mod_pow(A[i][i], p - 2, p) % p;
    }
    
    return x;
}
```

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** $O(n^3 \log p)$.

---

### –ó–∞–¥–∞—á–∞ 3: –ü–æ–¥—Å—á—ë—Ç –ø—É—Ç–µ–π –≤ –≥—Ä–∞—Ñ–µ

**–£—Å–ª–æ–≤–∏–µ:** –î–∞–Ω –≥—Ä–∞—Ñ $G$ —Å $n$ –≤–µ—Ä—à–∏–Ω–∞–º–∏. –ù–∞–π—Ç–∏ —á–∏—Å–ª–æ –ø—É—Ç–µ–π –¥–ª–∏–Ω—ã $k$ –∏–∑ –≤–µ—Ä—à–∏–Ω—ã $s$ –≤ –≤–µ—Ä—à–∏–Ω—É $t$ –ø–æ –º–æ–¥—É–ª—é $p$.

**–†–µ—à–µ–Ω–∏–µ:** –ú–∞—Ç—Ä–∏—Ü–∞ —Å–º–µ–∂–Ω–æ—Å—Ç–∏ + –±—ã—Å—Ç—Ä–æ–µ –≤–æ–∑–≤–µ–¥–µ–Ω–∏–µ –≤ —Å—Ç–µ–ø–µ–Ω—å.

```cpp
using Matrix = vector<vector<int64>>;

Matrix mul_matrix(const Matrix& A, const Matrix& B, int64 p) {
    int n = A.size();
    Matrix C(n, vector<int64>(n, 0));
    for (int i = 0; i < n; ++i)
        for (int j = 0; j < n; ++j)
            for (int k = 0; k < n; ++k)
                C[i][j] = (C[i][j] + (i128)A[i][k] * B[k][j]) % p;
    return C;
}

Matrix pow_matrix(Matrix A, int64 k, int64 p) {
    int n = A.size();
    Matrix res(n, vector<int64>(n, 0));
    for (int i = 0; i < n; ++i) res[i][i] = 1; // –µ–¥–∏–Ω–∏—á–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞
    
    while (k > 0) {
        if (k & 1) res = mul_matrix(res, A, p);
        A = mul_matrix(A, A, p);
        k >>= 1;
    }
    return res;
}

int64 count_paths(const Matrix& adj, int s, int t, int64 k, int64 p) {
    Matrix Ak = pow_matrix(adj, k, p);
    return Ak[s][t];
}
```

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** $O(n^3 \log k)$.

---

### –ó–∞–¥–∞—á–∞ 4: –†–∞–∑–ª–æ–∂–µ–Ω–∏–µ —á–∏—Å–ª–∞ –Ω–∞ —Å—É–º–º—É –¥–≤—É—Ö –∫–≤–∞–¥—Ä–∞—Ç–æ–≤

**–£—Å–ª–æ–≤–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –º–æ–∂–Ω–æ –ª–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å $n$ –∫–∞–∫ $a^2 + b^2$ –ø–æ –º–æ–¥—É–ª—é $p$.

**–†–µ—à–µ–Ω–∏–µ:** –ï—Å–ª–∏ $p \equiv 1 \pmod{4}$, —Ç–æ $-1$ ‚Äî –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—ã–π –≤—ã—á–µ—Ç. –ò—Å–ø–æ–ª—å–∑—É–µ–º –¢–æ–Ω–µ–ª–ª–∏-–®–µ–Ω–∫—Å.

```cpp
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –ø–æ–∏—Å–∫ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è
pair<int64, int64> sum_of_two_squares_mod(int64 n, int64 p) {
    // –£–ø—Ä–æ—â–∞–µ–º –∑–∞–¥–∞—á—É: –∏—â–µ–º a, b: a^2 + b^2 ‚â° n (mod p)
    
    // –ß–∞—Å—Ç–Ω—ã–π —Å–ª—É—á–∞–π: n ‚â° 0
    if (n % p == 0) return {0, 0};
    
    // –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º a, –ø—Ä–æ–≤–µ—Ä—è–µ–º b^2 = n - a^2
    for (int64 a = 0; a < p; ++a) {
        int64 b_sq = (n - (i128)a * a % p + p) % p;
        if (legendre(b_sq, p) == 1) {
            int64 b = tonelli_shanks(b_sq, p);
            if (b != -1) return {a, b};
        }
    }
    
    return {-1, -1}; // –Ω–µ—Ç —Ä–µ—à–µ–Ω–∏—è
}
```

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** –î–ª—è –±–æ–ª—å—à–∏—Ö $p$ –∏—Å–ø–æ–ª—å–∑—É–µ–º –∞–ª–≥–æ—Ä–∏—Ç–º –ö–æ—Ä–Ω–∞–∫–∫–∏–∞.

---

### –ó–∞–¥–∞—á–∞ 5: –î–∏—Å–∫—Ä–µ—Ç–Ω–æ–µ –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—Ä–æ–≤–∞–Ω–∏–µ (real challenge!)

**–£—Å–ª–æ–≤–∏–µ:** –î–∞–Ω–æ $g$, $h$, $p$ ($p$ ‚Äî –ø—Ä–æ—Å—Ç–æ–µ, $g$ ‚Äî –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π –∫–æ—Ä–µ–Ω—å). –ù–∞–π—Ç–∏ $x$: $g^x \equiv h \pmod{p}$.

**–†–µ—à–µ–Ω–∏–µ:** Baby-step Giant-step (—É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤—ã—à–µ).

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

```cpp
int main() {
    int64 p = 1000000007;
    int64 g = find_primitive_root(p); // g = 5
    int64 h = 123456789;
    
    int64 x = discrete_log(g, h, p);
    
    if (x != -1) {
        cout << "x = " << x << '\n';
        cout << "–ü—Ä–æ–≤–µ—Ä–∫–∞: " << mod_pow(g, x, p) << " == " << h << '\n';
    } else {
        cout << "–†–µ—à–µ–Ω–∏—è –Ω–µ—Ç\n";
    }
}
```

---

### –ó–∞–¥–∞—á–∞ 6: NTT –¥–ª—è —É–º–Ω–æ–∂–µ–Ω–∏—è –±–æ–ª—å—à–∏—Ö —á–∏—Å–µ–ª

**–£—Å–ª–æ–≤–∏–µ:** –£–º–Ω–æ–∂–∏—Ç—å –¥–≤–∞ –º–Ω–æ–≥–æ—á–ª–µ–Ω–∞ —Å—Ç–µ–ø–µ–Ω–∏ $\leq 10^5$.

**–†–µ—à–µ–Ω–∏–µ:** NTT (Number Theoretic Transform) ‚Äî –∞–Ω–∞–ª–æ–≥ FFT –¥–ª—è –º–æ–¥—É–ª—å–Ω–æ–π –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∏.

```cpp
// –†–µ–∫—É—Ä—Å–∏–≤–Ω–∞—è NTT (—É–ø—Ä–æ—â—ë–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)
void ntt(vector<int64>& a, bool inverse, int64 p, int64 g) {
    int n = a.size();
    if (n == 1) return;
    
    vector<int64> a0(n/2), a1(n/2);
    for (int i = 0; i < n/2; ++i) {
        a0[i] = a[2*i];
        a1[i] = a[2*i + 1];
    }
    
    ntt(a0, inverse, p, g);
    ntt(a1, inverse, p, g);
    
    int64 w = 1, wn = mod_pow(g, (p - 1) / n, p);
    if (inverse) wn = mod_pow(wn, p - 2, p);
    
    for (int i = 0; i < n/2; ++i) {
        int64 t = (i128)w * a1[i] % p;
        a[i] = (a0[i] + t) % p;
        a[i + n/2] = (a0[i] - t + p) % p;
        w = (i128)w * wn % p;
    }
}

vector<int64> multiply_poly_ntt(vector<int64> a, vector<int64> b, int64 p, int64 g) {
    int n = 1;
    while (n < a.size() + b.size() - 1) n <<= 1;
    a.resize(n); b.resize(n);
    
    ntt(a, false, p, g);
    ntt(b, false, p, g);
    
    for (int i = 0; i < n; ++i)
        a[i] = (i128)a[i] * b[i] % p;
    
    ntt(a, true, p, g);
    
    int64 n_inv = mod_pow(n, p - 2, p);
    for (auto& x : a) x = (i128)x * n_inv % p;
    
    return a;
}
```

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –°–≤—ë—Ä—Ç–∫–∏, —É–º–Ω–æ–∂–µ–Ω–∏–µ –¥–ª–∏–Ω–Ω—ã—Ö —á–∏—Å–µ–ª, –∫–æ–º–±–∏–Ω–∞—Ç–æ—Ä–Ω—ã–µ –∑–∞–¥–∞—á–∏.

---

## –®–ø–∞—Ä–≥–∞–ª–∫–∞: —á—Ç–æ –∑–∞–ø–æ–º–Ω–∏—Ç—å

| –¢–µ–º–∞ | –§–æ—Ä–º—É–ª–∞ / –£—Å–ª–æ–≤–∏–µ | –°–ª–æ–∂–Ω–æ—Å—Ç—å |
|------|-------------------|----------|
| –û–±—Ä–∞—Ç–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç | $a^{-1} \equiv a^{p-2} \pmod p$ | $O(\log p)$ |
| –ü—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π –∫–æ—Ä–µ–Ω—å | $g^{(p-1)/q} \not\equiv 1$ –¥–ª—è –≤—Å–µ—Ö –ø—Ä–æ—Å—Ç—ã—Ö $q \mid p-1$ | $O(\sqrt{p} + k \log p)$ |
| –°–∏–º–≤–æ–ª –õ–µ–∂–∞–Ω–¥—Ä–∞ | $a^{(p-1)/2} \bmod p$ | $O(\log p)$ |
| –ë—ã—Å—Ç—Ä—ã–π –õ–µ–∂–∞–Ω–¥—Ä | –ö–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—ã–π –∑–∞–∫–æ–Ω –≤–∑–∞–∏–º–Ω–æ—Å—Ç–∏ | $O(\log p)$ |
| –ö–≤–∞–¥—Ä–∞—Ç–Ω—ã–π –∫–æ—Ä–µ–Ω—å | Tonelli‚ÄìShanks | $O(\log^2 p)$ |
| –†–µ—à–µ–Ω–∏–µ –∫–≤–∞–¥—Ä–∞—Ç–Ω–æ–≥–æ —É—Ä–∞–≤–Ω–µ–Ω–∏—è | $x = \frac{-B \pm \sqrt{D}}{2}$ | –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ—Ä–Ω—è |
| –î–∏—Å–∫—Ä–µ—Ç–Ω—ã–π –ª–æ–≥–∞—Ä–∏—Ñ–º | Baby-step Giant-step | $O(\sqrt{p})$ |
| NTT | –ü—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π –∫–æ—Ä–µ–Ω—å —Å—Ç–µ–ø–µ–Ω–∏ $2^k$ | $O(n \log n)$ |

---

## –ü–æ–ª–µ–∑–Ω—ã–µ –ª–∞–π—Ñ—Ö–∞–∫–∏ –∏ —Ç–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏

‚úÖ **–í—Å–µ–≥–¥–∞ –Ω–æ—Ä–º–∞–ª–∏–∑—É–π –æ—Å—Ç–∞—Ç–∫–∏**:  
```cpp
x = (x % p + p) % p;
```

‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–π `__int128` –ø—Ä–∏ —É–º–Ω–æ–∂–µ–Ω–∏–∏**:  
```cpp
(i128)a * b % p
```

‚úÖ **–î–ª—è –±–∏–Ω–æ–º–∏–∞–ª—å–Ω—ã—Ö –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤** ‚Äî –ø—Ä–µ–¥–ø–æ–¥—Å—á—ë—Ç —Ñ–∞–∫—Ç–æ—Ä–∏–∞–ª–æ–≤.

‚úÖ **–î–ª—è –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–≥–æ –ª–æ–≥–∞—Ä–∏—Ñ–º–∞** ‚Äî –ø—Ä–æ–≤–µ—Ä—å, —á—Ç–æ $g$ ‚Äî –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π –∫–æ—Ä–µ–Ω—å.

‚úÖ **–î–ª—è NTT** ‚Äî –ø—Ä–æ–≤–µ—Ä—å, —á—Ç–æ $p = c \cdot 2^k + 1$ –∏ $n \mid 2^k$.

‚ùå **–ù–µ –¥–µ–ª–∏ –Ω–∞ 2 –∫–∞–∫ `x / 2`** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π `mod_inv(2, p)` –∏–ª–∏ `x * (p+1)/2 % p`.

‚ùå **–ù–µ –∑–∞–±—ã–≤–∞–π, —á—Ç–æ $p$ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–µ—á—ë—Ç–Ω—ã–º** –≤ Tonelli‚ÄìShanks.

‚ùå **–°–∏–º–≤–æ–ª –õ–µ–∂–∞–Ω–¥—Ä–∞ = 1 –ù–ï –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è —Å–æ—Å—Ç–∞–≤–Ω–æ–≥–æ –º–æ–¥—É–ª—è!**

‚úÖ **–ï—Å–ª–∏ $p = 2$** ‚Äî –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–π –æ—Ç–¥–µ–ª—å–Ω–æ (—Ç–∞–º –≤—Å—ë —Ç—Ä–∏–≤–∏–∞–ª—å–Ω–æ).

‚úÖ **–§–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è $p-1$** ‚Äî –ø–µ—Ä–µ–±–æ—Ä –¥–æ $\sqrt{p}$ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è $p \leq 10^9$.

‚úÖ **–ü–µ—Ä–≤—ã–π –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π –∫–æ—Ä–µ–Ω—å –ø–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ ‚â§ 10** ‚Äî –Ω–µ –±–æ–π—Å—è –ø–µ—Ä–µ–±–∏—Ä–∞—Ç—å.

‚úÖ **–ö–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—ã–π –∑–∞–∫–æ–Ω –≤–∑–∞–∏–º–Ω–æ—Å—Ç–∏** ‚Äî –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –±–µ–∑ –≤–æ–∑–≤–µ–¥–µ–Ω–∏—è –≤ —Å—Ç–µ–ø–µ–Ω—å!

---

## –°–≤—è–∑—å —Å –¥—Ä—É–≥–∏–º–∏ —Ä–∞–∑–¥–µ–ª–∞–º–∏ –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏

### –¢–µ–æ—Ä–∏—è –≥—Ä—É–ø–ø

- $\mathbb{Z}_p^*$ ‚Äî —Ü–∏–∫–ª–∏—á–µ—Å–∫–∞—è –≥—Ä—É–ø–ø–∞ –ø–æ—Ä—è–¥–∫–∞ $p-1$
- –¢–µ–æ—Ä–µ–º–∞ –õ–∞–≥—Ä–∞–Ω–∂–∞: –ø–æ—Ä—è–¥–æ–∫ —ç–ª–µ–º–µ–Ω—Ç–∞ –¥–µ–ª–∏—Ç –ø–æ—Ä—è–¥–æ–∫ –≥—Ä—É–ø–ø—ã
- –ò–∑–æ–º–æ—Ä—Ñ–∏–∑–º –º–µ–∂–¥—É $(\mathbb{Z}_p^*, \cdot)$ –∏ $(\mathbb{Z}_{p-1}, +)$ —á–µ—Ä–µ–∑ –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π –∫–æ—Ä–µ–Ω—å

### –¢–µ–æ—Ä–∏—è –∫–æ–ª–µ—Ü –∏ –ø–æ–ª–µ–π

- $\mathbb{Z}_p$ ‚Äî –ø—Ä–æ—Å—Ç–µ–π—à–∏–π –ø—Ä–∏–º–µ—Ä –∫–æ–Ω–µ—á–Ω–æ–≥–æ –ø–æ–ª—è
- –†–∞—Å—à–∏—Ä–µ–Ω–∏—è –ø–æ–ª–µ–π: $\mathbb{F}_{p^n} = \mathbb{Z}_p[x] / (P(x))$, –≥–¥–µ $P(x)$ ‚Äî –Ω–µ–ø—Ä–∏–≤–æ–¥–∏–º—ã–π –º–Ω–æ–≥–æ—á–ª–µ–Ω
- –ê–ª–≥–µ–±—Ä–∞–∏—á–µ—Å–∫–æ–µ –∑–∞–º—ã–∫–∞–Ω–∏–µ $\overline{\mathbb{Z}_p}$

### –ê–ª–≥–µ–±—Ä–∞–∏—á–µ—Å–∫–∞—è –≥–µ–æ–º–µ—Ç—Ä–∏—è

- –≠–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–∏–µ –∫—Ä–∏–≤—ã–µ –Ω–∞–¥ $\mathbb{Z}_p$: $y^2 = x^3 + ax + b$
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ—á–µ–∫ –Ω–∞ –∫—Ä–∏–≤–æ–π: —Ç–µ–æ—Ä–µ–º–∞ –•–∞—Å—Å–µ
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏ (ECDSA, Diffie-Hellman)

### –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è

- RSA: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–µ–æ—Ä–µ–º—É –≠–π–ª–µ—Ä–∞ –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
- Diffie-Hellman: –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–≥–æ –ª–æ–≥–∞—Ä–∏—Ñ–º–∞
- ElGamal, DSA: –ø–æ–¥–ø–∏—Å–∏ —Å –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–º–∏ –∫–æ—Ä–Ω—è–º–∏

### –¢–µ–æ—Ä–∏—è —á–∏—Å–µ–ª

- –ö–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—ã–µ —Ñ–æ—Ä–º—ã: $ax^2 + bxy + cy^2$
- –¢–µ–æ—Ä–µ–º–∞ –æ —Å—É–º–º–µ —á–µ—Ç—ã—Ä—ë—Ö –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ (–õ–∞–≥—Ä–∞–Ω–∂)
- –ì–∏–ø–æ—Ç–µ–∑–∞ –ì–æ–ª—å–¥–±–∞—Ö–∞, –ø—Ä–æ–±–ª–µ–º–∞ –±–ª–∏–∑–Ω–µ—Ü–æ–≤ (open problems!)

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã

### –ö–∏—Ç–∞–π—Å–∫–∞—è —Ç–µ–æ—Ä–µ–º–∞ –æ–± –æ—Å—Ç–∞—Ç–∫–∞—Ö (CRT)

**–¢–µ–æ—Ä–µ–º–∞:** –°–∏—Å—Ç–µ–º–∞
$$\begin{cases} x \equiv a_1 \pmod{m_1} \\ x \equiv a_2 \pmod{m_2} \\ \vdots \\ x \equiv a_k \pmod{m_k} \end{cases}$$

–∏–º–µ–µ—Ç –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø–æ –º–æ–¥—É–ª—é $M = m_1 m_2 \cdots m_k$, –µ—Å–ª–∏ $\gcd(m_i, m_j) = 1$ –¥–ª—è $i \neq j$.

```cpp
int64 crt(const vector<int64>& a, const vector<int64>& m) {
    int64 M = 1;
    for (auto x : m) M *= x;
    
    int64 result = 0;
    for (int i = 0; i < a.size(); ++i) {
        int64 Mi = M / m[i];
        int64 yi = mod_pow(Mi, euler_phi(m[i]) - 1, m[i]); // Mi^(-1) mod m[i]
        result = (result + (i128)a[i] * Mi % M * yi % M) % M;
    }
    
    return result;
}
```

### –ê–ª–≥–æ—Ä–∏—Ç–º –ü–æ–ª–ª–∞—Ä–¥–∞ œÅ –¥–ª—è –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–≥–æ –ª–æ–≥–∞—Ä–∏—Ñ–º–∞

–î–ª—è –æ—á–µ–Ω—å –±–æ–ª—å—à–∏—Ö $p$ Baby-step Giant-step —Ç—Ä–µ–±—É–µ—Ç –º–Ω–æ–≥–æ –ø–∞–º—è—Ç–∏. –ê–ª–≥–æ—Ä–∏—Ç–º –ü–æ–ª–ª–∞—Ä–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç $O(1)$ –ø–∞–º—è—Ç–∏ –∏ $O(\sqrt{p})$ –≤—Ä–µ–º–µ–Ω–∏.

**–ò–¥–µ—è:** –°—Ç—Ä–æ–∏–º –ø—Å–µ–≤–¥–æ—Å–ª—É—á–∞–π–Ω—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å $x_i = g^{a_i} h^{b_i}$ –∏ –∏—â–µ–º –∫–æ–ª–ª–∏–∑–∏—é $x_i = x_j$.

### –¢–µ—Å—Ç –ú–∏–ª–ª–µ—Ä–∞-–†–∞–±–∏–Ω–∞ (–ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Å—Ç–æ—Ç—ã)

```cpp
bool miller_rabin(int64 n, int iterations = 10) {
    if (n < 2) return false;
    if (n == 2) return true;
    if (n % 2 == 0) return false;
    
    int64 d = n - 1, r = 0;
    while (d % 2 == 0) { d /= 2; ++r; }
    
    auto check = [&](int64 a) {
        int64 x = mod_pow(a, d, n);
        if (x == 1 || x == n - 1) return true;
        for (int i = 0; i < r - 1; ++i) {
            x = (i128)x * x % n;
            if (x == n - 1) return true;
        }
        return false;
    };
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –±–∞–∑–∞—Ö
    vector<int64> bases = {2, 3, 5, 7, 11, 13, 17, 19, 23};
    for (auto a : bases) {
        if (a >= n) continue;
        if (!check(a)) return false;
    }
    return true;
}
```

---

## –®–ø–∞—Ä–≥–∞–ª–∫–∞: —á—Ç–æ –∑–∞–ø–æ–º–Ω–∏—Ç—å

| –¢–µ–º–∞ | –§–æ—Ä–º—É–ª–∞ / –£—Å–ª–æ–≤–∏–µ | –°–ª–æ–∂–Ω–æ—Å—Ç—å |
|------|-------------------|----------|
| –û–±—Ä–∞—Ç–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç | $a^{-1} \equiv a^{p-2} \pmod p$ | $O(\log p)$ |
| –ü—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π –∫–æ—Ä–µ–Ω—å | $g^{(p-1)/q} \not\equiv 1$ –¥–ª—è –≤—Å–µ—Ö –ø—Ä–æ—Å—Ç—ã—Ö $q \mid p-1$ | $O(\sqrt{p} + k \log p)$ |
| –°–∏–º–≤–æ–ª –õ–µ–∂–∞–Ω–¥—Ä–∞ | $a^{(p-1)/2} \bmod p$ | $O(\log p)$ |
| –ö–≤–∞–¥—Ä–∞—Ç–Ω—ã–π –∫–æ—Ä–µ–Ω—å | Tonelli‚ÄìShanks | $O(\log^2 p)$ |
| –†–µ—à–µ–Ω–∏–µ –∫–≤–∞–¥—Ä–∞—Ç–Ω–æ–≥–æ —É—Ä–∞–≤–Ω–µ–Ω–∏—è | $x = \frac{-B \pm \sqrt{D}}{2}$ | –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ—Ä–Ω—è |

---

## –ü–æ–ª–µ–∑–Ω—ã–µ –ª–∞–π—Ñ—Ö–∞–∫–∏ –∏ —Ç–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏

‚úÖ **–í—Å–µ–≥–¥–∞ –Ω–æ—Ä–º–∞–ª–∏–∑—É–π –æ—Å—Ç–∞—Ç–∫–∏**:  
```cpp
x = (x % p + p) % p;
```

‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–π `__int128` –ø—Ä–∏ —É–º–Ω–æ–∂–µ–Ω–∏–∏**:  
```cpp
(i128)a * b % p
```

‚ùå **–ù–µ –¥–µ–ª–∏ –Ω–∞ 2 –∫–∞–∫ `x / 2`** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π `mod_inv(2, p)`.

‚ùå **–ù–µ –∑–∞–±—ã–≤–∞–π, —á—Ç–æ $p$ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–µ—á—ë—Ç–Ω—ã–º** –≤ Tonelli‚ÄìShanks.

‚úÖ **–ï—Å–ª–∏ $p = 2$** ‚Äî –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–π –æ—Ç–¥–µ–ª—å–Ω–æ (—Ç–∞–º –≤—Å—ë —Ç—Ä–∏–≤–∏–∞–ª—å–Ω–æ).

‚úÖ **–§–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è $p-1$** ‚Äî –ø–µ—Ä–µ–±–æ—Ä –¥–æ $\sqrt{p}$ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è $p \leq 10^9$.

‚úÖ **–ü–µ—Ä–≤—ã–π –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π –∫–æ—Ä–µ–Ω—å –ø–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ ‚â§ 10** ‚Äî –Ω–µ –±–æ–π—Å—è –ø–µ—Ä–µ–±–∏—Ä–∞—Ç—å.

---

## –ë–∞–∑–æ–≤–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ ‚Äî –≥–æ—Ç–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

–ó–¥–µ—Å—å —Å–æ–±—Ä–∞–Ω—ã –≤—Å–µ –∫–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ copy-paste:

```cpp
#include <bits/stdc++.h>
using namespace std;
using i128 = __int128;
using int64 = long long;

// ============ –ë–ê–ó–û–í–´–ï –§–£–ù–ö–¶–ò–ò ============

// –ë—ã—Å—Ç—Ä–æ–µ –≤–æ–∑–≤–µ–¥–µ–Ω–∏–µ –≤ —Å—Ç–µ–ø–µ–Ω—å –ø–æ –º–æ–¥—É–ª—é
int64 mod_pow(int64 a, int64 e, int64 p) {
    int64 result = 1;
    a %= p;
    while (e > 0) {
        if (e & 1) result = (i128)result * a % p;
        a = (i128)a * a % p;
        e >>= 1;
    }
    return result;
}

// –û–±—Ä–∞—Ç–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç (–§–µ—Ä–º–∞)
int64 mod_inv(int64 a, int64 p) {
    return mod_pow(a, p - 2, p);
}

// –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –ï–≤–∫–ª–∏–¥–∞
int64 extended_gcd(int64 a, int64 b, int64& x, int64& y) {
    if (b == 0) {
        x = 1; y = 0;
        return a;
    }
    int64 x1, y1;
    int64 d = extended_gcd(b, a % b, x1, y1);
    x = y1;
    y = x1 - (a / b) * y1;
    return d;
}

// –û–±—Ä–∞—Ç–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç (–ï–≤–∫–ª–∏–¥)
int64 mod_inv_egcd(int64 a, int64 p) {
    int64 x, y;
    extended_gcd(a, p, x, y);
    return (x % p + p) % p;
}

// –§—É–Ω–∫—Ü–∏—è –≠–π–ª–µ—Ä–∞
int64 euler_phi(int64 n) {
    int64 result = n;
    for (int64 p = 2; p * p <= n; ++p) {
        if (n % p == 0) {
            while (n % p == 0) n /= p;
            result -= result / p;
        }
    }
    if (n > 1) result -= result / n;
    return result;
}

// ============ –ü–†–ò–ú–ò–¢–ò–í–ù–´–ï –ö–û–†–ù–ò ============

// –§–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–∏—Å–ª–∞
vector<int64> prime_factors(int64 n) {
    vector<int64> f;
    for (int64 p = 2; p * p <= n; ++p) {
        if (n % p == 0) {
            f.push_back(p);
            while (n % p == 0) n /= p;
        }
    }
    if (n > 1) f.push_back(n);
    return f;
}

// –ü–æ–∏—Å–∫ –ø—Ä–∏–º–∏—Ç–∏–≤–Ω–æ–≥–æ –∫–æ—Ä–Ω—è
int64 find_primitive_root(int64 p) {
    if (p == 2) return 1;
    auto primes = prime_factors(p - 1);
    for (int64 g = 2; g < p; ++g) {
        bool ok = true;
        for (int64 q : primes) {
            if (mod_pow(g, (p - 1) / q, p) == 1) {
                ok = false;
                break;
            }
        }
        if (ok) return g;
    }
    return -1;
}

// ============ –ö–í–ê–î–†–ê–¢–ò–ß–ù–´–ï –í–´–ß–ï–¢–´ ============

// –°–∏–º–≤–æ–ª –õ–µ–∂–∞–Ω–¥—Ä–∞
int legendre(int64 a, int64 p) {
    a %= p;
    if (a < 0) a += p;
    if (a == 0) return 0;
    int64 r = mod_pow(a, (p - 1) / 2, p);
    return (r == 1) ? 1 : -1;
}

// –ë—ã—Å—Ç—Ä—ã–π —Å–∏–º–≤–æ–ª –õ–µ–∂–∞–Ω–¥—Ä–∞ (—á–µ—Ä–µ–∑ –∑–∞–∫–æ–Ω –≤–∑–∞–∏–º–Ω–æ—Å—Ç–∏)
int legendre_fast(int64 a, int64 p) {
    a %= p;
    if (a < 0) a += p;
    
    int result = 1;
    while (a != 0) {
        while (a % 2 == 0) {
            a /= 2;
            if (p % 8 == 3 || p % 8 == 5)
                result = -result;
        }
        
        if (a % 4 == 3 && p % 4 == 3)
            result = -result;
        
        swap(a, p);
        a %= p;
    }
    
    return (p == 1) ? result : 0;
}

// –°–∏–º–≤–æ–ª –Ø–∫–æ–±–∏ (–¥–ª—è —Å–æ—Å—Ç–∞–≤–Ω—ã—Ö —á–∏—Å–µ–ª)
int jacobi(int64 a, int64 n) {
    if (n <= 0 || n % 2 == 0) return 0;
    
    a %= n;
    if (a < 0) a += n;
    
    int result = 1;
    while (a != 0) {
        while (a % 2 == 0) {
            a /= 2;
            if (n % 8 == 3 || n % 8 == 5)
                result = -result;
        }
        
        if (a % 4 == 3 && n % 4 == 3)
            result = -result;
        
        swap(a, n);
        a %= n;
    }
    
    return (n == 1) ? result : 0;
}

// –ê–ª–≥–æ—Ä–∏—Ç–º –¢–æ–Ω–µ–ª–ª–∏-–®–µ–Ω–∫—Å–∞
int64 tonelli_shanks(int64 a, int64 p) {
    if (a == 0) return 0;
    if (p == 2) return a;
    if (legendre(a, p) != 1) return -1;

    int64 q = p - 1, s = 0;
    while ((q & 1) == 0) { q >>= 1; ++s; }

    if (s == 1) return mod_pow(a, (p + 1) / 4, p);

    int64 z = 2;
    while (legendre(z, p) != -1) ++z;

    int64 c = mod_pow(z, q, p);
    int64 r = mod_pow(a, (q + 1) / 2, p);
    int64 t = mod_pow(a, q, p);
    int64 m = s;

    while (t != 1) {
        int64 i = 0, tt = t;
        while (tt != 1) {
            tt = (i128)tt * tt % p;
            ++i;
            if (i == m) return -1;
        }
        int64 b = mod_pow(c, 1LL << (m - i - 1), p);
        r = (i128)r * b % p;
        c = (i128)b * b % p;
        t = (i128)t * c % p;
        m = i;
    }
    return r;
}

// ============ –î–ò–°–ö–†–ï–¢–ù–´–ô –õ–û–ì–ê–†–ò–§–ú ============

// Baby-step Giant-step
int64 discrete_log(int64 g, int64 h, int64 p) {
    int64 m = (int64)sqrt(p) + 1;
    
    unordered_map<int64, int64> table;
    int64 cur = 1;
    for (int64 i = 0; i < m; ++i) {
        table[cur] = i;
        cur = (i128)cur * g % p;
    }
    
    int64 g_inv_m = mod_pow(g, p - 1 - m, p);
    cur = h;
    for (int64 j = 0; j < m; ++j) {
        if (table.count(cur))
            return j * m + table[cur];
        cur = (i128)cur * g_inv_m % p;
    }
    
    return -1;
}

// ============ –§–ê–ö–¢–û–†–ò–ê–õ–´ –ò –ë–ò–ù–û–ú–´ ============

const int MAXN = 1e6;
vector<int64> fact, inv_fact;

void precompute_factorials(int n, int64 p) {
    fact.resize(n + 1);
    inv_fact.resize(n + 1);
    
    fact[0] = 1;
    for (int i = 1; i <= n; ++i)
        fact[i] = (i128)fact[i-1] * i % p;
    
    inv_fact[n] = mod_pow(fact[n], p - 2, p);
    for (int i = n - 1; i >= 0; --i)
        inv_fact[i] = (i128)inv_fact[i+1] * (i + 1) % p;
}

int64 C(int n, int k, int64 p) {
    if (k > n || k < 0) return 0;
    return (i128)fact[n] * inv_fact[k] % p * inv_fact[n-k] % p;
}

// ============ –ö–ò–¢–ê–ô–°–ö–ê–Ø –¢–ï–û–†–ï–ú–ê –û–ë –û–°–¢–ê–¢–ö–ê–• ============

int64 crt(const vector<int64>& a, const vector<int64>& m) {
    int64 M = 1;
    for (auto x : m) M *= x;
    
    int64 result = 0;
    for (int i = 0; i < a.size(); ++i) {
        int64 Mi = M / m[i];
        int64 yi = mod_inv(Mi, m[i]);
        result = (result + (i128)a[i] * Mi % M * yi % M) % M;
    }
    
    return result;
}

// ============ –¢–ï–°–¢ –ü–†–û–°–¢–û–¢–´ ============

bool miller_rabin(int64 n, int iterations = 10) {
    if (n < 2) return false;
    if (n == 2) return true;
    if (n % 2 == 0) return false;
    
    int64 d = n - 1, r = 0;
    while (d % 2 == 0) { d /= 2; ++r; }
    
    auto check = [&](int64 a) {
        int64 x = mod_pow(a, d, n);
        if (x == 1 || x == n - 1) return true;
        for (int i = 0; i < r - 1; ++i) {
            x = (i128)x * x % n;
            if (x == n - 1) return true;
        }
        return false;
    };
    
    vector<int64> bases = {2, 3, 5, 7, 11, 13, 17, 19, 23};
    for (auto a : bases) {
        if (a >= n) continue;
        if (!check(a)) return false;
    }
    return true;
}
```

### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```cpp
int main() {
    int64 p = 1e9 + 7;
    
    // –ë–∏–Ω–æ–º–∏–∞–ª—å–Ω—ã–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã
    precompute_factorials(MAXN, p);
    cout << "C(1000, 500) mod p = " << C(1000, 500, p) << '\n';
    
    // –ü—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π –∫–æ—Ä–µ–Ω—å
    int64 g = find_primitive_root(p);
    cout << "Primitive root of " << p << " is " << g << '\n';
    
    // –ö–≤–∞–¥—Ä–∞—Ç–Ω—ã–π –∫–æ—Ä–µ–Ω—å
    int64 a = 123456;
    int64 sqrt_a = tonelli_shanks(a, p);
    if (sqrt_a != -1) {
        cout << "sqrt(" << a << ") mod " << p << " = " << sqrt_a << '\n';
        // –ü—Ä–æ–≤–µ—Ä–∫–∞
        cout << "Check: " << (i128)sqrt_a * sqrt_a % p << '\n';
    }
    
    // –î–∏—Å–∫—Ä–µ—Ç–Ω—ã–π –ª–æ–≥–∞—Ä–∏—Ñ–º
    int64 h = mod_pow(g, 123, p);
    int64 x = discrete_log(g, h, p);
    cout << "log_" << g << "(" << h << ") mod " << p << " = " << x << '\n';
    
    return 0;
}
```

---

## –í–∏–∑—É–∞–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∏ —Å—Ö–µ–º—ã

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ–ª—è $\mathbb{Z}_p$

```mermaid
graph TB
    subgraph "–ü–æ–ª–µ Z_p"
        A["–≠–ª–µ–º–µ–Ω—Ç—ã: {0, 1, 2, ..., p-1}"]
        B["–°–ª–æ–∂–µ–Ω–∏–µ (+)"]
        C["–£–º–Ω–æ–∂–µ–Ω–∏–µ (¬∑)"]
        D["–û–±—Ä–∞—Ç–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã"]
    end
    
    subgraph "–ì—Ä—É–ø–ø–∞ Z_p*"
        E["{1, 2, ..., p-1}"]
        F["–ü—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π –∫–æ—Ä–µ–Ω—å g"]
        G["g^1, g^2, ..., g^(p-1)"]
    end
    
    A --> B
    A --> C
    C --> D
    E --> F
    F --> G
```

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∏—Å–∫—Ä–µ—Ç–Ω—ã–π –ª–æ–≥–∞—Ä–∏—Ñ–º

```mermaid
graph LR
    A["–ó–∞–¥–∞—á–∞: –Ω–∞–π—Ç–∏ x"] --> B["g^x ‚â° h (mod p)"]
    B --> C["Baby-step Giant-step"]
    C --> D["x = jm + i"]
    D --> E["–¢–∞–±–ª–∏—Ü–∞: g^i"]
    D --> F["–ò—Ç–µ—Ä–∞—Ü–∏—è: h ¬∑ (g^-m)^j"]
    E --> G["–ö–æ–ª–ª–∏–∑–∏—è!"]
    F --> G
    G --> H["–û—Ç–≤–µ—Ç: x"]
```

### –ê–ª–≥–æ—Ä–∏—Ç–º –¢–æ–Ω–µ–ª–ª–∏-–®–µ–Ω–∫—Å–∞ (—Å—Ö–µ–º–∞)

```mermaid
flowchart TD
    A["–î–∞–Ω–æ: a, p"] --> B["p-1 = q ¬∑ 2^s"]
    B --> C["–ù–∞–π—Ç–∏ z: –Ω–µ–≤—ã—á–µ—Ç"]
    C --> D["c = z^q, r = a^((q+1)/2), t = a^q"]
    D --> E{"t = 1?"}
    E -->|–î–∞| F["–û—Ç–≤–µ—Ç: r"]
    E -->|–ù–µ—Ç| G["–ù–∞–π—Ç–∏ i: t^(2^i) = 1"]
    G --> H["b = c^(2^(m-i-1))"]
    H --> I["r = r¬∑b, t = t¬∑b^2, c = b^2, m = i"]
    I --> E
```

### –ö–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—ã–π –∑–∞–∫–æ–Ω –≤–∑–∞–∏–º–Ω–æ—Å—Ç–∏ (–≤–∏–∑—É–∞–ª—å–Ω–æ)

–î–ª—è –ø—Ä–æ—Å—Ç—ã—Ö $p, q$:

$$\left( \frac{p}{q} \right) \left( \frac{q}{p} \right) = (-1)^{(p-1)(q-1)/4}$$

| $p \bmod 4$ | $q \bmod 4$ | –ó–Ω–∞–∫ |
|-------------|-------------|------|
| 1 | –ª—é–±–æ–µ | + |
| –ª—é–±–æ–µ | 1 | + |
| 3 | 3 | - |

---

$\text{–û—Ç —É—á–µ–Ω–∏–∫–∞ –¥–ª—è —É—á–µ–Ω–∏–∫–æ–≤.}\\ \text{\textcolor{red}{–° –ª—é–±–æ–≤—å—é} –∫ \textcolor{yellow}{–¢-–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏—é}.}\\ \textcolor{#86cecb}{–í–∞–¥–∏–º\ –•—Ä–∏—Å—Ç–µ–Ω–∫–æ.}$

---
title: "–ü–∞—Ä–∞–ª–ª–µ–ª—å B<br>–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ: –ø–æ–ª–Ω—ã–π —Ä–∞–∑–±–æ—Ä"
timestamp: 2025-10-19T18:45:00+03:00
last_updated_timestamp: 2025-11-01T18:30:00+03:00
series: "T-–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ"
tags:
  - Tbank
  - Tgeneration
  - DynamicProgramming
  - DP
  - Optimization
description: >-
  –ü–æ–ª–Ω—ã–π –∫—É—Ä—Å –ø–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–º—É –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—é: –æ—Ç –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á (–ù–û–ü, –ù–í–ü)
  –¥–æ —Å–ª–æ–∂–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ä—é–∫–∑–∞–∫–∞. –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å DP? –ö–∞–∫ –ø–µ—Ä–µ–π—Ç–∏ –æ—Ç –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏
  –∫ –∫–æ–¥—É? –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ç—Ä—é–∫–∏ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏.
---

<h2>–¢–µ–º–∞ –∫–æ–Ω—Å–ø–µ–∫—Ç–∞: –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Äî –æ—Ç –æ—Å–Ω–æ–≤ –∫ –º–∞—Å—Ç–µ—Ä—Å—Ç–≤—É</h2>

> **–ì–ª–∞–≤–Ω—ã–π –∞–≤—Ç–æ—Ä:** –í–∞–¥–∏–º –•—Ä–∏—Å—Ç–µ–Ω–∫–æ  
> **–î—Ä—É–≥–∏–µ –∞–≤—Ç–æ—Ä—ã:** ‚Äî  
> **–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-11-01  
> **–°—Å—ã–ª–∫–∞ –Ω–∞ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ:** https://github.com/Vadim-Khristenko/Tedu_Notes/discussions/2  
> _–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:_ –ö–æ–Ω—Å–ø–µ–∫—Ç —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∫–æ–¥–∞, –ø–æ—à–∞–≥–æ–≤—ã–º–∏ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è–º–∏ –∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–º–∏ —à–∞–±–ª–æ–Ω–∞–º–∏. –î–ª—è —Ç–µ—Ö, –∫—Ç–æ —É–∂–µ –Ω–µ–º–Ω–æ–≥–æ –∑–Ω–∞–µ—Ç, –Ω–æ —Ö–æ—á–µ—Ç —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –Ω–∞–∫–æ–Ω–µ—Ü.  
> _–¢–µ–≥–∏:_ DP, Dynamic Programming, Optimization, –ù–û–ü, –ù–í–ü, Knapsack

---

# –í–≤–µ–¥–µ–Ω–∏–µ {id: "introduction"}

**–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ (DP)** ‚Äî —ç—Ç–æ –Ω–µ –º–∞–≥–∏—è, –∞ –ø—Ä–æ—Å—Ç–æ —Å–ø–æ—Å–æ–± —ç–∫–æ–Ω–æ–º–∏—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏—è, –∑–∞–ø–æ–º–∏–Ω–∞—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–¥–∑–∞–¥–∞—á.

–ï—Å–ª–∏ –∑–∞–¥–∞—á–∞ —Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—é—â–∏–µ—Å—è –ø–æ–¥–∑–∞–¥–∞—á–∏, –∏ –º—ã –º–æ–∂–µ–º –≤—ã—Ä–∞–∑–∏—Ç—å –æ—Ç–≤–µ—Ç —á–µ—Ä–µ–∑ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –º–µ–Ω—å—à–∏–µ –ø–æ–¥–∑–∞–¥–∞—á–∏, —Ç–æ —ç—Ç–æ DP.

> üí° **–ì–ª–∞–≤–Ω–∞—è –∏–¥–µ—è:** –í–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—Ç—å –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ, –≤—ã—á–∏—Å–ª–∏–º –æ–¥–∏–Ω —Ä–∞–∑ –∏ —Å–æ—Ö—Ä–∞–Ω–∏–º –≤ —Ç–∞–±–ª–∏—Ü—É.

---

# –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ {id: "contents"}

1. [DP –ø–æ –ø–æ–¥–æ—Ç—Ä–µ–∑–∫–∞–º](#dp-by-substring)
   - [–ù–∞–∏–±–æ–ª—å—à–∞—è –æ–±—â–∞—è –ø–æ–¥–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–ù–û–ü)](#lcs)
   - [–ù–∞–∏–±–æ–ª—å—à–∞—è –≤–æ–∑—Ä–∞—Å—Ç–∞—é—â–∞—è –ø–æ–¥–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–ù–í–ü)](#lis)
2. [DP –ø–æ –ø–æ–¥–¥–µ—Ä–µ–≤—å—è–º](#dp-by-subtree)
3. [–†—é–∫–∑–∞–∫](#knapsack)
   - [0-1 –†—é–∫–∑–∞–∫](#knapsack-0-1)
   - [–ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π —Ä—é–∫–∑–∞–∫](#knapsack-unbounded)
   - [–†—é–∫–∑–∞–∫ –±–µ–∑ —Å—Ç–æ–∏–º–æ—Å—Ç–∏](#knapsack-no-cost)
4. [–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏ —Ç—Ä—é–∫–∏](#optimizations)
5. [–ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏](#mistakes)

---

# DP –ø–æ –ø–æ–¥–æ—Ç—Ä–µ–∑–∫–∞–º {id: "dp-by-substring"}

–°–∞–º—ã–π —á–∞—Å—Ç—ã–π —Å–ª—É—á–∞–π: –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–¥–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π —Å—Ç—Ä–æ–∫/–º–∞—Å—Å–∏–≤–æ–≤.

## –ù–∞–∏–±–æ–ª—å—à–∞—è –æ–±—â–∞—è –ø–æ–¥–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–ù–û–ü) {id: "lcs"}

**–ó–∞–¥–∞—á–∞:** –î–∞–Ω—ã –¥–≤–µ —Å—Ç—Ä–æ–∫–∏ $A$ –∏ $B$. –ù–∞–π—Ç–∏ –¥–ª–∏–Ω—É –Ω–∞–∏–±–æ–ª—å—à–µ–π –æ–±—â–µ–π –ø–æ–¥–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏–¥—É—â–µ–π –ø–æ–¥—Ä—è–¥).

**–ü—Ä–∏–º–µ—Ä:** 
- $A = \text{"ABCD"}$
- $B = \text{"ACD"}$
- –û—Ç–≤–µ—Ç: $3$ (–ø–æ–¥–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å $\text{"ACD"}$)

### –ò–Ω—Ç—É–∏—Ü–∏—è

–û–ø—Ä–µ–¥–µ–ª–∏–º $dp[i][j]$ = –¥–ª–∏–Ω–∞ –ù–û–ü –ø–µ—Ä–≤—ã—Ö $i$ —Å–∏–º–≤–æ–ª–æ–≤ $A$ –∏ –ø–µ—Ä–≤—ã—Ö $j$ —Å–∏–º–≤–æ–ª–æ–≤ $B$.

**–†–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ:**
$$
dp[i][j] = \begin{cases}
0 & \text{–µ—Å–ª–∏ } i=0 \text{ –∏–ª–∏ } j=0 \\
dp[i-1][j-1] + 1 & \text{–µ—Å–ª–∏ } A[i-1] = B[j-1] \\
\max(dp[i-1][j], dp[i][j-1]) & \text{–∏–Ω–∞—á–µ}
\end{cases}
$$

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

```cpp
#include <bits/stdc++.h>
using namespace std;

int lcs(string A, string B) {
    int n = A.length(), m = B.length();
    vector<vector<int>> dp(n + 1, vector<int>(m + 1, 0));
    
    for (int i = 1; i <= n; i++) {
        for (int j = 1; j <= m; j++) {
            if (A[i-1] == B[j-1]) {
                dp[i][j] = dp[i-1][j-1] + 1;
            } else {
                dp[i][j] = max(dp[i-1][j], dp[i][j-1]);
            }
        }
    }
    
    return dp[n][m];
}

int main() {
    cout << lcs("ABCD", "ACD") << endl; // –í—ã–≤–µ–¥–µ—Ç 3
    return 0;
}
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∞–º–æ–π –ø–æ–¥–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

```cpp
string reconstruct_lcs(string A, string B) {
    int n = A.length(), m = B.length();
    vector<vector<int>> dp(n + 1, vector<int>(m + 1, 0));
    
    for (int i = 1; i <= n; i++) {
        for (int j = 1; j <= m; j++) {
            if (A[i-1] == B[j-1]) {
                dp[i][j] = dp[i-1][j-1] + 1;
            } else {
                dp[i][j] = max(dp[i-1][j], dp[i][j-1]);
            }
        }
    }
    
    string result = "";
    int i = n, j = m;
    while (i > 0 && j > 0) {
        if (A[i-1] == B[j-1]) {
            result = A[i-1] + result;
            i--; j--;
        } else if (dp[i-1][j] > dp[i][j-1]) {
            i--;
        } else {
            j--;
        }
    }
    
    return result;
}
```

---

## –ù–∞–∏–±–æ–ª—å—à–∞—è –≤–æ–∑—Ä–∞—Å—Ç–∞—é—â–∞—è –ø–æ–¥–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–ù–í–ü) {id: "lis"}

**–ó–∞–¥–∞—á–∞:** –î–∞–Ω –º–∞—Å—Å–∏–≤ —Ü–µ–ª—ã—Ö —á–∏—Å–µ–ª. –ù–∞–π—Ç–∏ –¥–ª–∏–Ω—É –Ω–∞–∏–±–æ–ª—å—à–µ–π –≤–æ–∑—Ä–∞—Å—Ç–∞—é—â–µ–π –ø–æ–¥–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

**–ü—Ä–∏–º–µ—Ä:**
- –ú–∞—Å—Å–∏–≤: $[10, 9, 2, 5, 3, 7, 101, 18]$
- –ù–í–ü: $[2, 3, 7, 101]$ –∏–ª–∏ $[2, 3, 7, 18]$
- –î–ª–∏–Ω–∞: $4$

### –ü–æ–¥—Ö–æ–¥ O(n¬≤)

–û–ø—Ä–µ–¥–µ–ª–∏–º $dp[i]$ = –¥–ª–∏–Ω–∞ –ù–í–ü –∑–∞–∫–∞–Ω—á–∏–≤–∞—é—â–µ–π—Å—è –≤ $i$-–º —ç–ª–µ–º–µ–Ω—Ç–µ.

$$
dp[i] = 1 + \max_{j < i, arr[j] < arr[i]} dp[j]
$$

```cpp
int lis_n2(vector<int> arr) {
    int n = arr.size();
    vector<int> dp(n, 1);
    
    for (int i = 1; i < n; i++) {
        for (int j = 0; j < i; j++) {
            if (arr[j] < arr[i]) {
                dp[i] = max(dp[i], dp[j] + 1);
            }
        }
    }
    
    return *max_element(dp.begin(), dp.end());
}
```

### –ü–æ–¥—Ö–æ–¥ O(n log n) —Å –±–∏–Ω–∞—Ä–Ω—ã–º –ø–æ–∏—Å–∫–æ–º

–•—Ä–∞–Ω–∏–º –º–∞—Å—Å–∏–≤ `tail`, –≥–¥–µ `tail[k]` = –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Å–ª–µ–¥–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç –ù–í–ü –¥–ª–∏–Ω—ã $k+1$.

```cpp
int lis_nlogn(vector<int> arr) {
    vector<int> tail; // tail[k] = –Ω–∞–∏–º–µ–Ω—å—à–∏–π –ø–æ—Å–ª–µ–¥–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç –ù–í–ü –¥–ª–∏–Ω—ã k+1
    
    for (int x : arr) {
        auto it = lower_bound(tail.begin(), tail.end(), x);
        if (it == tail.end()) {
            tail.push_back(x);
        } else {
            *it = x;
        }
    }
    
    return tail.size();
}
```

**–ü–æ—á–µ–º—É —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?**
- –ï—Å–ª–∏ –Ω–∞–π–¥—ë–º —ç–ª–µ–º–µ–Ω—Ç $\geq x$ –Ω–∞ –ø–æ–∑–∏—Ü–∏–∏ `it`, –∑–∞–º–µ–Ω–∏–º –µ–≥–æ –Ω–∞ $x$ (—Ç–∞–∫ –∫–∞–∫ $x$ –º–µ–Ω—å—à–µ, –ª—É—á—à–µ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å —Å –Ω–µ–≥–æ).
- –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥—ë–º, –¥–æ–±–∞–≤–∏–º –≤ –∫–æ–Ω–µ—Ü (–Ω–æ–≤–∞—è, –±–æ–ª–µ–µ –¥–ª–∏–Ω–Ω–∞—è –ù–í–ü).
- –ú–∞—Å—Å–∏–≤ `tail` –≤—Å–µ–≥–¥–∞ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—é.

---

# DP –ø–æ –ø–æ–¥–¥–µ—Ä–µ–≤—å—è–º {id: "dp-by-subtree"}

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∑–∞–¥–∞—á –Ω–∞ –¥–µ—Ä–µ–≤—å—è—Ö, –≥–¥–µ –Ω—É–∂–Ω–æ –ø–æ—Å—á–∏—Ç–∞—Ç—å —á—Ç–æ-—Ç–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–¥–¥–µ—Ä–µ–≤–∞.

**–ü—Ä–∏–º–µ—Ä –∑–∞–¥–∞—á–∏:** –ù–∞–π—Ç–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –≤–µ—Å –ø—É—Ç–∏ –≤ –¥–µ—Ä–µ–≤–µ, –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—â–∏–π —Å–æ—Å–µ–¥–Ω–∏—Ö –≤–µ—Ä—à–∏–Ω.

```cpp
struct TreeDP {
    vector<vector<int>> adj;
    vector<vector<long long>> dp; // dp[v][0] = –±–µ–∑ v, dp[v][1] = —Å v
    int n;
    
    TreeDP(int n) : n(n), adj(n), dp(n, vector<long long>(2, 0)) {}
    
    void dfs(int v, int parent, vector<long long>& weight) {
        dp[v][0] = 0;
        dp[v][1] = weight[v];
        
        for (int u : adj[v]) {
            if (u == parent) continue;
            dfs(u, v, weight);
            
            dp[v][0] += max(dp[u][0], dp[u][1]);
            dp[v][1] += dp[u][0]; // –µ—Å–ª–∏ –±–µ—Ä—ë–º v, –Ω–µ –±–µ—Ä—ë–º u
        }
    }
    
    long long solve(vector<long long>& weight) {
        dfs(0, -1, weight);
        return max(dp[0][0], dp[0][1]);
    }
};
```

---

# –†—é–∫–∑–∞–∫ {id: "knapsack"}

–°–µ–º–µ–π—Å—Ç–≤–æ –∑–∞–¥–∞—á –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏: –≤—ã–±—Ä–∞—Ç—å –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø—Ä–µ–¥–º–µ—Ç–æ–≤, –º–∞–∫—Å–∏–º–∏–∑–∏—Ä—É—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–∏ –ø–æ –≤–µ—Å—É.

## 0-1 –†—é–∫–∑–∞–∫ {id: "knapsack-0-1"}

–ö–∞–∂–¥—ã–π –ø—Ä–µ–¥–º–µ—Ç –º–æ–∂–Ω–æ –≤–∑—è—Ç—å **–º–∞–∫—Å–∏–º—É–º –æ–¥–∏–Ω —Ä–∞–∑**.

**–§–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞:** –î–∞–Ω—ã $n$ –ø—Ä–µ–¥–º–µ—Ç–æ–≤ —Å –≤–µ—Å–∞–º–∏ $w_i$ –∏ —Å—Ç–æ–∏–º–æ—Å—Ç—è–º–∏ $v_i$. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –≤–µ—Å —Ä—é–∫–∑–∞–∫–∞ = $W$. –ù–∞–π—Ç–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å.

### –†–µ—à–µ–Ω–∏–µ O(nW)

$dp[i][w]$ = –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å —Å –ø–µ—Ä–≤—ã–º–∏ $i$ –ø—Ä–µ–¥–º–µ—Ç–∞–º–∏ –∏ –≤–µ—Å–æ–º ‚â§ $w$.

$$
dp[i][w] = \max(dp[i-1][w], dp[i-1][w-w_i] + v_i)
$$

(–µ—Å–ª–∏ $w \geq w_i$, –∏–Ω–∞—á–µ –ø–µ—Ä–≤—ã–π –≤–∞—Ä–∏–∞–Ω—Ç)

```cpp
int knapsack_01(vector<int> w, vector<int> v, int W) {
    int n = w.size();
    vector<vector<int>> dp(n + 1, vector<int>(W + 1, 0));
    
    for (int i = 1; i <= n; i++) {
        for (int j = W; j >= w[i-1]; j--) {
            dp[i][j] = max(dp[i-1][j], dp[i-1][j-w[i-1]] + v[i-1]);
        }
    }
    
    return dp[n][W];
}
```

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ –ø–∞–º—è—Ç–∏:** –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–¥–Ω–æ–º–µ—Ä–Ω—ã–π –º–∞—Å—Å–∏–≤, –ø—Ä–æ—Ö–æ–¥—è —Å–ø—Ä–∞–≤–∞ –Ω–∞–ª–µ–≤–æ.

```cpp
int knapsack_01_1d(vector<int> w, vector<int> v, int W) {
    vector<int> dp(W + 1, 0);
    
    for (int i = 0; i < w.size(); i++) {
        for (int j = W; j >= w[i]; j--) {
            dp[j] = max(dp[j], dp[j - w[i]] + v[i]);
        }
    }
    
    return dp[W];
}
```

---

## –ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π —Ä—é–∫–∑–∞–∫ {id: "knapsack-unbounded"}

–ö–∞–∂–¥—ã–π –ø—Ä–µ–¥–º–µ—Ç –º–æ–∂–Ω–æ –≤–∑—è—Ç—å **–Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–∑**.

**–†–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ:**
$$
dp[w] = \max_{i: w_i \leq w} (dp[w - w_i] + v_i)
$$

```cpp
int knapsack_unbounded(vector<int> w, vector<int> v, int W) {
    vector<int> dp(W + 1, 0);
    
    for (int j = 1; j <= W; j++) {
        for (int i = 0; i < w.size(); i++) {
            if (w[i] <= j) {
                dp[j] = max(dp[j], dp[j - w[i]] + v[i]);
            }
        }
    }
    
    return dp[W];
}
```

**–ö–ª—é—á–µ–≤–æ–µ –æ—Ç–ª–∏—á–∏–µ:** –ü—Ä–æ—Ö–æ–¥–∏–º **—Å–ª–µ–≤–∞ –Ω–∞–ø—Ä–∞–≤–æ**, —á—Ç–æ–±—ã –æ–¥–∏–Ω –ø—Ä–µ–¥–º–µ—Ç –º–æ–∂–Ω–æ –±—ã–ª–æ –≤—ã–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑.

---

## –†—é–∫–∑–∞–∫ –±–µ–∑ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ (—Å—á—ë—Ç —Å–ø–æ—Å–æ–±–æ–≤) {id: "knapsack-no-cost"}

**–ó–∞–¥–∞—á–∞:** –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ø–æ—Å–æ–±–æ–≤ –≤—ã–±—Ä–∞—Ç—å –ø—Ä–µ–¥–º–µ—Ç—ã —Ä–æ–≤–Ω–æ —Å –≤–µ—Å–æ–º $w$.

```cpp
int knapsack_counting(vector<int> w, int W) {
    vector<int> dp(W + 1, 0);
    dp[0] = 1; // –æ–¥–∏–Ω —Å–ø–æ—Å–æ–± ‚Äî –Ω–∏—á–µ–≥–æ –Ω–µ –±—Ä–∞—Ç—å
    
    for (int i = 0; i < w.size(); i++) {
        for (int j = W; j >= w[i]; j--) {
            dp[j] += dp[j - w[i]];
        }
    }
    
    return dp[W];
}
```

---

# –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏ —Ç—Ä—é–∫–∏ {id: "optimizations"}

## –°–≤—ë—Ä—Ç–∫–∞ –≤–≤–µ—Ä—Ö –ø–∞–º—è—Ç–∏

–í–º–µ—Å—Ç–æ 2D —Ç–∞–±–ª–∏—Ü—ã —á–∞—Å—Ç–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ 1D, –µ—Å–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å.

## –ü–µ—Ä–µ—Å—á—ë—Ç –≥—Ä–∞–Ω–∏—Ü

–ï—Å–ª–∏ $W$ –æ–≥—Ä–æ–º–Ω–æ–µ, –Ω–æ —Ä–µ–∞–ª—å–Ω–æ –Ω—É–∂–Ω–æ $W'$ ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω.

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–∏—Ç–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

–î–ª—è –ø–æ–¥—Å—á—ë—Ç–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–ø–æ—Å–æ–±–æ–≤ —Å –±–æ–ª—å—à–∏–º–∏ –º–æ–¥—É–ª—è–º–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º –±–∏—Ç–æ–≤—ã–µ —Ç—Ä—é–∫–∏ –∏ FFT –¥–ª—è –æ—á–µ–Ω—å –±–æ–ª—å—à—ã—Ö —á–∏—Å–µ–ª.

---

# –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏ {id: "mistakes"}

| –û—à–∏–±–∫–∞ | –ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏–µ | –ö–∞–∫ –∏–∑–±–µ–∂–∞—Ç—å |
|--------|------------|------------|
| –ü—Ä–æ—Ö–æ–¥ —Å–ª–µ–≤–∞ –Ω–∞–ø—Ä–∞–≤–æ –≤ 0-1 —Ä—é–∫–∑–∞–∫–µ | –û–¥–∏–Ω –ø—Ä–µ–¥–º–µ—Ç –±–µ—Ä—ë—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ | –ü—Ä–æ—Ö–æ–¥–∏—Ç—å —Å–ø—Ä–∞–≤–∞ –Ω–∞–ª–µ–≤–æ |
| –ó–∞–±—ã–ª–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å `dp[0] = 0` | –ù–µ–≤–µ—Ä–Ω—ã–π –æ—Ç–≤–µ—Ç | –Ø–≤–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å |
| –ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–∏ –ø–æ–¥—Å—á—ë—Ç–µ —Å–ø–æ—Å–æ–±–æ–≤ | –ù–µ–≤–µ—Ä–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `long long` –∏–ª–∏ –º–æ–¥—É–ª—å–Ω—É—é –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫—É |
| –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ç–∞–±–ª–∏—Ü—ã –ù–û–ü | –í—ã—Ö–æ–¥ –∑–∞ –≥—Ä–∞–Ω–∏—Ü—ã | –í—Å–µ–≥–¥–∞ —Ä–∞–∑–º–µ—Ä $(n+1) \times (m+1)$ |

---

$\text{–û—Ç —É—á–µ–Ω–∏–∫–∞ –¥–ª—è —É—á–µ–Ω–∏–∫–æ–≤.}\\ \text{\textcolor{red}{–° –ª—é–±–æ–≤—å—é} –∫ \textcolor{yellow}{–¢-–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏—é}.}\\ \textcolor{cyan}{–í–∞–¥–∏–º\ –•—Ä–∏—Å—Ç–µ–Ω–∫–æ.}$
